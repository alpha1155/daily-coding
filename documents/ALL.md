## ä¸€ã€Java æ ¸å¿ƒä¸å¹¶å‘ï¼ˆå¤§å‚å¿…è€ƒï¼‰

| ç¼–å· | é—®é¢˜                                                         | è€ƒå¯Ÿç‚¹             | å¤§å‚å‡ºé¢˜æ¦‚ç‡    | ç­”æ¡ˆæ¡†æ¶                                                     |
| ---- | ------------------------------------------------------------ | ------------------ | --------------- | ------------------------------------------------------------ |
| 1    | `ConcurrentHashMap` åœ¨ JDK 8 ä¸­æ˜¯å¦‚ä½•å®ç°é«˜å¹¶å‘çš„ï¼Ÿ`synchronized` é”çš„æ˜¯ä»€ä¹ˆï¼Ÿ | å¹¶å‘å®¹å™¨ã€é”åˆ†æ®µ   | å­—èŠ‚/é˜¿é‡Œ 5æ˜Ÿ   | `Node[] table` + `synchronized(firstNode)`ï¼Œåªæœ‰å†™æ“ä½œé”å¤´èŠ‚ç‚¹ï¼Œè¯»ä¸åŠ é”ï¼›æ‰©å®¹æ—¶ `transfer` ä½¿ç”¨ `ForwardingNode` |
| 2    | æ‰‹å†™ï¼šå®ç°ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„ **é˜»å¡é˜Ÿåˆ—**ï¼ˆ`BlockingQueue`ï¼‰ï¼Œæ”¯æŒ `put` å’Œ `take` | å¹¶å‘ç¼–ç¨‹ã€ç­‰å¾…é€šçŸ¥ | å­—èŠ‚/å¿«æ‰‹ 4æ˜Ÿ   | ç”¨ `ReentrantLock` + `notEmpty`/`notFull` æ¡ä»¶ï¼›`await/signal` æœºåˆ¶<br />put<br />take<br />size |
| 3    | `ThreadPoolExecutor` çš„ä»»åŠ¡æ‰§è¡Œæµç¨‹ï¼Ÿ`execute` vs `submit` åŒºåˆ«ï¼Ÿ | çº¿ç¨‹æ± åŸç†         | é˜¿é‡Œ/å°çº¢ä¹¦ 4æ˜Ÿ | `execute` æ— è¿”å›å€¼ï¼Œ`submit` è¿”å› `Future`ï¼›æµç¨‹ï¼šcore â†’ queue â†’ max â†’ reject |
| 4    | `volatile` èƒ½ä¿è¯åŸå­æ€§å—ï¼Ÿ`i++` ä¸ºä»€ä¹ˆä¸æ˜¯åŸå­æ“ä½œï¼Ÿ        | å†…å­˜æ¨¡å‹ã€æŒ‡ä»¤é‡æ’ | å­—èŠ‚ 5æ˜Ÿ        | ä¸ä¿è¯ï¼›â€œvolatile åªä¿è¯ä¸¤ä¸ªä¸œè¥¿ï¼š<br />**å¯è§æ€§**ï¼šä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹åï¼Œç«‹å³åˆ·æ–°åˆ°ä¸»å†…å­˜ï¼Œå…¶ä»–çº¿ç¨‹å¼ºåˆ¶ä»ä¸»å†…å­˜è¯»ã€‚<br /> **ç¦æ­¢æŒ‡ä»¤é‡æ’åº**ï¼šå†™æ˜¯ releaseï¼Œè¯»æ˜¯ acquireï¼Œå½¢æˆ happens-beforeã€‚<br />`i++` æ˜¯ä¸‰æ­¥ï¼šè¯»-æ”¹-å†™ï¼›éœ€ç”¨ `AtomicInteger` |
| 5    | `CompletableFuture` å¦‚ä½•å®ç° **å¼‚å¸¸ä¼ æ’­** å’Œ **è¶…æ—¶æ§åˆ¶**ï¼Ÿ  | å¼‚æ­¥ç¼–æ’           | å¿«æ‰‹/å­—èŠ‚ 3æ˜Ÿ   | `exceptionally` / `handle` å¤„ç†å¼‚å¸¸ï¼›`orTimeout(2, TimeUnit.SECONDS)` |

## 1.ConcurrentHashMap

ConcurrentHashMap æ˜¯ Java å¹¶å‘å®¹å™¨ä¸­æ€§èƒ½æœ€é«˜ã€çº¿ç¨‹æœ€å®‰å…¨çš„ Map å®ç°ï¼Œé€šè¿‡ åˆ†æ®µé” + CAS + æ— é”è¯» + çº¢é»‘æ ‘ä¼˜åŒ–ï¼Œå®ç° é«˜å¹¶å‘è¯»å†™ä¸é˜»å¡ã€‚

| ç‰¹æ€§                   | è¯´æ˜                                          |
| ---------------------- | --------------------------------------------- |
| **æ— é”è¯»**             | `get()` æ“ä½œå®Œå…¨æ— é”ï¼Œæ€§èƒ½æ¥è¿‘ `HashMap`      |
| **æ¡¶çº§é”**             | å†™æ“ä½œåªé” **å•ä¸ª bucket**ï¼Œå¹¶å‘åº¦é«˜          |
| **CAS + synchronized** | ç©ºæ¡¶æ’å…¥ç”¨ CASï¼Œå†²çªæ¡¶ç”¨ `synchronized(æ¡¶å¤´)` |
| **çº¢é»‘æ ‘ä¼˜åŒ–**         | é“¾è¡¨é•¿åº¦ â‰¥8 æ—¶è½¬ä¸ºçº¢é»‘æ ‘ï¼Œé˜² Hash æ”»å‡»        |
| **åŠ¨æ€æ‰©å®¹**           | å¤šçº¿ç¨‹åä½œæ‰©å®¹ï¼Œè¯»å†™ä¸é˜»å¡                    |
| **å¼±ä¸€è‡´æ€§**           | `size()` æ˜¯è¿‘ä¼¼å€¼ï¼Œè¿­ä»£å™¨ä¸åæ˜ æœ€æ–°ä¿®æ”¹       |

| #    | é¢˜ç›®                                                         | æ ‡å‡†ç­”æ¡ˆ                                                     |
| ---- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 1    | **ConcurrentHashMap ä¸ HashMapã€Hashtable çš„åŒºåˆ«ï¼Ÿ**         | HashMapæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼ŒHashTableæ˜¯é”ä½äº†æ•´å¼ è¡¨Synchronizedï¼Œå¹¶å‘åº¦ä½ï¼ŒConcurrentHashmap bucket Synchronized+CAS, è¯»æ— é”ï¼Œå†™åªé”å•ä¸ªbucketï¼Œæ€§èƒ½æœ€é«˜ |
| 2    | **JDK 7 ä¸ JDK 8 ä¸­ ConcurrentHashMap çš„å®ç°æœ‰ä½•ä¸åŒï¼Ÿ**     | JDK7ä½¿ç”¨äº†Segment åˆ†æ®µé”ï¼Œ JDK8æŠ›å¼ƒäº†segmentï¼Œä½¿ç”¨bucket synchronized+CASï¼Œå¹¶å‘åº¦=bucket æ•° |
| 3    | **ConcurrentHashMap çš„ `put` æµç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ**                | 1.è®¡ç®—hash->bucketç´¢å¼•<br />2.è‹¥bucketä¸ºç©ºï¼ŒCASæ’å…¥å¤´èŠ‚ç‚¹<br />3.è‹¥ä¸ä¸ºç©ºï¼Œsynchronizedå¤´èŠ‚ç‚¹ï¼Œ-.é“¾è¡¨/çº¢é»‘æ ‘æ’å…¥<br />4.é“¾è¡¨é•¿åº¦>=8 ï¼Œtable length>=64ï¼Œé“¾è¡¨è½¬çº¢é»‘æ ‘<br />5.è®¡æ•°ã€è§¦å‘æ‰©å®¹ã€‚ |
| 4    | **ä¸ºä»€ä¹ˆ `get` æ“ä½œä¸éœ€è¦é”ï¼Ÿ**                              | get() ä¸éœ€è¦é”ï¼Œå› ä¸ºå®ƒåªè¯» volatile å­—æ®µï¼ŒJVM çš„ happens-before è§„åˆ™ä¿è¯å¯è§æ€§ï¼Œè¯»çº¿ç¨‹æ°¸è¿œçœ‹åˆ°â€œæœ€æ–°æäº¤çš„å†™â€ï¼<br />â€œè¯»ä¸é˜»å¡ã€å¼±ä¸€è‡´ã€é«˜æ€§èƒ½â€ |
| 5    | **`synchronized` é”çš„æ˜¯ä»€ä¹ˆå¯¹è±¡ï¼Ÿ**                          | synchronized(f) ä¸­çš„ f æ˜¯å½“å‰ bucket çš„ ç¬¬ä¸€ä¸ª Node èŠ‚ç‚¹ï¼ˆæ¡¶å¤´èŠ‚ç‚¹ï¼‰ï¼Œä¹Ÿå°±æ˜¯ table[index] ä½ç½®çš„é‚£ä¸ª Node å¯¹è±¡ï¼** |
| 6    | **æ‰©å®¹ï¼ˆresizeï¼‰æ—¶å¦‚ä½•ä¿è¯å¹¶å‘å®‰å…¨ï¼Ÿ**                       | 1. åˆ›å»ºæ–°è¡¨ï¼ˆ2Ã—å®¹é‡ï¼‰<br/>2. å¤šçº¿ç¨‹è¿ç§»æ—§è¡¨ â†’ æ–°è¡¨<br/>3. å†™ ForwardingNode åˆ°æ—§æ¡¶<br/>4. æ‰€æœ‰æ¡¶è¿ç§»å®Œ â†’ table = æ–°è¡¨<br />**ConcurrentHashMap æ‰©å®¹å®‰å…¨é ï¼š** **ForwardingNode åšâ€œè·¯æ ‡â€ + å¤šçº¿ç¨‹åä½œè¿ç§» + volatile table åˆ‡æ¢ + é«˜ä½ä½åˆ†ç¦»ç®—æ³•** **å®ç°â€œè¯»å†™ä¸é˜»å¡ã€æ•°æ®ä¸ä¸¢å¤±ã€é«˜å¹¶å‘æ‰©å®¹â€çš„æè‡´è®¾è®¡ï¼** |
| 7    | **ä¸ºä»€ä¹ˆä¸å…è®¸ `null` key/valueï¼Ÿ**                          | ä¸ºäº†è®© get() çš„è¿”å›ç»“æœ null èƒ½ æ˜ç¡®è¡¨ç¤ºâ€œé”®ä¸å­˜åœ¨â€ï¼Œè€Œä¸è¢«â€œå€¼æ˜¯ nullâ€ æ··æ·†ï¼Œä»è€Œä¿æŒè¯­ä¹‰æ¸…æ™°ä¸çº¿ç¨‹å®‰å…¨ï¼** |
| 8    | **`size()` æ˜¯çº¿ç¨‹å®‰å…¨çš„å—ï¼Ÿ**                                | size() çº¿ç¨‹å®‰å…¨ï¼ˆä¸ä¼šå´©æºƒï¼‰ï¼Œä½†è¿”å›å€¼å¯èƒ½ä¸æ˜¯å½“å‰çœŸå®å…ƒç´ ä¸ªæ•° â€”â€” å®ƒæ˜¯â€œé«˜å¹¶å‘ä¸‹å®‰å…¨ä¼°ç®—â€çš„ç»“æœã€‚mappingCount() è·å–æ›´ç²¾ç¡®çš„ long å€¼ï¼Œ |
| 9    | **CAS å¯èƒ½å‡ºç° ABA é—®é¢˜å—ï¼ŸConcurrentHashMap ä¼šå—å½±å“å—ï¼Ÿ**  | CAS å¯èƒ½å‡ºç° ABA é—®é¢˜ï¼Œä½† ConcurrentHashMap å®Œå…¨ä¸å— ABA é—®é¢˜å½±å“ã€‚å…è®¸è¯¯å·®ï¼ˆsize() å¼±ä¸€è‡´ï¼‰<br />ConcurrentHashMap çš„ CAS æ“ä½œ è¦ä¹ˆçŠ¶æ€ä¸å¯é€†ï¼ˆæ—  ABAï¼‰ï¼Œ è¦ä¹ˆå…è®¸è¯¯å·®ï¼ˆè®¡æ•°å¼±ä¸€è‡´ï¼‰ï¼Œ |
| 10   | **ä»€ä¹ˆæ—¶å€™ä¼šæŠŠé“¾è¡¨è½¬æˆçº¢é»‘æ ‘ï¼Ÿ**                             | 8ï¼Œ64                                                        |
| 11   | **å¦‚ä½•æ‰‹åŠ¨è§¦å‘æ‰©å®¹ï¼Ÿ**                                       | æ’å…¥è¶…è¿‡ åˆå§‹å®¹é‡ Ã— 0.75 ä¸ªå…ƒç´ ï¼Œ å†…éƒ¨è‡ªåŠ¨è§¦å‘ transfer()    |
| 12   | **ConcurrentHashMap é€‚åˆåšç¼“å­˜å—ï¼Ÿ**                         | ConcurrentHashMap éå¸¸é€‚åˆåšç¼“å­˜<br />é«˜å¹¶å‘ + é«˜æ€§èƒ½ + çº¿ç¨‹å®‰å…¨ + åŠ¨æ€æ‰©å®¹ + é›¶ä¾èµ–ï¼Œ<br />é…åˆ computeIfAbsent + å®šæœŸæ¸…ç†<br />ä¸é€‚åˆåˆ†å¸ƒå¼ç¼“å­˜ï¼Œç”¨ Redis<br />é…ç½®ç¼“å­˜ï¼Œç”¨æˆ·ä¼šè¯ï¼Œçƒ­ç‚¹æ•°æ®ï¼Œè®¡æ•°å™¨ |
| 13   | **å¦‚æœè¦ç»Ÿè®¡å…¨å±€è®¡æ•°ï¼Œåº”è¯¥ç”¨å“ªä¸ª APIï¼Ÿ**                     | åŸå­æ“ä½œï¼šæŸ¥ + ç®— + å­˜ ä¸€æ­¥å®Œæˆ<br />æ— é”ç«äº‰ï¼šå†…éƒ¨ç”¨ CAS + æ¡¶çº§é”<br />é«˜æ€§èƒ½:æ¥è¿‘ AtomicLong<br />è¯­ä¹‰æ¸…æ™°ï¼šä¸€è¡Œä»£ç è¡¨è¾¾â€œç´¯åŠ â€<br />æ”¯æŒä»»æ„åˆå¹¶ï¼šLong::sum, Integer::sum, Math::max ç­‰ |
| 14   | **ConcurrentHashMap çš„é»˜è®¤å¹¶å‘åº¦æ˜¯å¤šå°‘ï¼Ÿ**                   | ConcurrentHashMap é»˜è®¤å¹¶å‘åº¦æ˜¯ 16ï¼Œ JDK 8+ ä¸­è¯¥å‚æ•°ä»…ç”¨äºå…¼å®¹ï¼ŒçœŸå®å¹¶å‘åº¦ç”± table.lengthï¼ˆæ¡¶æ•°é‡ï¼‰å†³å®šï¼Œ ç”Ÿäº§ä¸­æ— éœ€è®¾ç½®ï¼Œé‡ç‚¹æ˜¯é¢„ä¼° initialCapacityï¼ |
| 15   | **åœ¨é«˜å¹¶å‘å†™åœºæ™¯ä¸‹ï¼Œ`ConcurrentHashMap` ä¼šé€€åŒ–ä¸ºå•çº¿ç¨‹å—ï¼Ÿ** | ConcurrentHashMap åœ¨é«˜å¹¶å‘å†™åœºæ™¯ä¸‹ ä¸ä¼šé€€åŒ–ä¸ºå•çº¿ç¨‹ â€”â€” å®ƒé€šè¿‡ â€œæ¡¶çº§é”â€ + â€œCASâ€ å®ç° çœŸæ­£çš„å¤šçº¿ç¨‹å¹¶å‘å†™ï¼Œæ€§èƒ½éš bucket æ•°é‡çº¿æ€§æ‰©å±•ï¼ |

## 2.ReentrantLock

**lock.lock() å’Œ lock.lockInterruptibly() çš„ä¸»è¦åŒºåˆ«æ˜¯æ˜¯å¦æ”¯æŒä¸­æ–­**ï¼š

1. **lock.lock()**ï¼šä¸å¯ä¸­æ–­ï¼Œçº¿ç¨‹ä¼šä¸€ç›´é˜»å¡ç›´åˆ°è·å–é”ã€‚å³ä½¿è¢« interrupt()ï¼Œä¹Ÿä¸ä¼šæŠ›å¼‚å¸¸ï¼Œåªè®°å½•ä¸­æ–­çŠ¶æ€ã€‚
2. **lock.lockInterruptibly()**ï¼šå¯ä¸­æ–­ï¼Œåœ¨ç­‰å¾…é”æ—¶è‹¥æ”¶åˆ°ä¸­æ–­ä¿¡å·ï¼Œä¼šç«‹å³æŠ›å‡º InterruptedExceptionï¼Œæ”¾å¼ƒè·å–é”ã€‚

### 3.ThreadPoolExecutor

```java
public ThreadPoolExecutor(
    int corePoolSize,
    int maximumPoolSize,
    long keepAliveTime,
    TimeUnit unit,
    BlockingQueue<Runnable> workQueue,
    ThreadFactory threadFactory,
    RejectedExecutionHandler handler
)
```

| åºå· | å‚æ•°              | ç±»å‹                       | å«ä¹‰                       | æºç å…³é”®ç‚¹                  | ç”Ÿäº§å»ºè®®                                             |
| ---- | ----------------- | -------------------------- | -------------------------- | --------------------------- | ---------------------------------------------------- |
| 1    | `corePoolSize`    | `int`                      | **æ ¸å¿ƒçº¿ç¨‹æ•°**ï¼ˆå¸¸é©»ï¼‰     | `addWorker(command, true)`  | **CPU å¯†é›†å‹ï¼šCPUæ ¸æ•°Ã—1** **IO å¯†é›†å‹ï¼šCPUæ ¸æ•°Ã—2~4** |
| 2    | `maximumPoolSize` | `int`                      | **æœ€å¤§çº¿ç¨‹æ•°**ï¼ˆå³°å€¼ï¼‰     | `addWorker(command, false)` | **ä¸è¶…è¿‡ 2Ã—core**ï¼Œé˜² OOM                            |
| 3    | `keepAliveTime`   | `long`                     | **éæ ¸å¿ƒçº¿ç¨‹ç©ºé—²å›æ”¶æ—¶é—´** | `worker.canTimeout()`       | **30~60s**ï¼Œå¤ªçŸ­é¢‘ç¹åˆ›å»ºï¼Œå¤ªé•¿æµªè´¹èµ„æº               |
| 4    | `unit`            | `TimeUnit`                 | æ—¶é—´å•ä½                   | `TimeUnit.SECONDS`          | ç»Ÿä¸€ç”¨ `SECONDS`                                     |
| 5    | `workQueue`       | `BlockingQueue<Runnable>`  | **ä»»åŠ¡ç¼“å†²é˜Ÿåˆ—**           | `workQueue.offer()`         | è§ä¸‹è¡¨                                               |
| 6    | `threadFactory`   | `ThreadFactory`            | **çº¿ç¨‹åˆ›å»ºå·¥å‚**           | `new Thread(...)`           | **è‡ªå®šä¹‰å‘½å + å®ˆæŠ¤ + ä¼˜å…ˆçº§**                       |
| 7    | `handler`         | `RejectedExecutionHandler` | **æ‹’ç»ç­–ç•¥**               | `reject(command)`           | **CallerRunsPolicy**ï¼ˆé˜²é›ªå´©ï¼‰                       |

```
// CPU æ ¸æ•°
int cpu = Runtime.getRuntime().availableProcessors();

// CPU å¯†é›†å‹ï¼ˆå¦‚è®¡ç®—ã€ç¼–ç ï¼‰
corePoolSize = cpu;
maximumPoolSize = cpu * 2;

// IO å¯†é›†å‹ï¼ˆå¦‚ DBã€HTTPã€æ–‡ä»¶ï¼‰
corePoolSize = cpu * 2;
maximumPoolSize = cpu * 4;
```

| é˜Ÿåˆ—                          | æœ‰ç•Œ/æ— ç•Œ                     | é˜»å¡è¡Œä¸º             | é€‚ç”¨åœºæ™¯           | é£é™©           |
| ----------------------------- | ----------------------------- | -------------------- | ------------------ | -------------- |
| `SynchronousQueue`            | **æ— ç•Œï¼ˆå®¹é‡0ï¼‰**             | ç”Ÿäº§è€…å¿…é¡»ç­‰å¾…æ¶ˆè´¹è€… | é«˜å¹¶å‘ã€æ— ç¼“å†²     | çº¿ç¨‹çˆ†ç‚¸       |
| `LinkedBlockingQueue<>(N)`    | **æœ‰ç•Œ**                      | `offer` éé˜»å¡       | **æ¨è**ï¼Œæ§åˆ¶èƒŒå‹ | é˜Ÿåˆ—ç§¯å‹       |
| `LinkedBlockingQueue`ï¼ˆæ— å‚ï¼‰ | **æ— ç•Œï¼ˆInteger.MAX_VALUEï¼‰** | `put` é˜»å¡           | **ç¦æ­¢ï¼**         | **OOM é£é™©ï¼** |
| `ArrayBlockingQueue<>(N)`     | æœ‰ç•Œ                          | `offer` éé˜»å¡       | å›ºå®šå®¹é‡           | æ€§èƒ½ç•¥ä½       |
| `PriorityBlockingQueue`       | æ— ç•Œ                          | `put` é˜»å¡           | ä¼˜å…ˆçº§ä»»åŠ¡         | OOM é£é™©       |

| ç­–ç•¥                                            | å£è¯€     | ä¸šåŠ¡åœºæ™¯                 |
| ----------------------------------------------- | -------- | ------------------------ |
| AbortPolicy                                     | **æŠ¥é”™** | å¼€å‘/æµ‹è¯•ç¯å¢ƒ            |
| CallerRunsPolicy-(ä¸ä¸¢ä»»åŠ¡ + è‡ªåŠ¨é™æµ + é˜²é›ªå´©) | **æ…¢å›** | æ ¸å¿ƒä¸šåŠ¡ï¼ˆå¦‚è®¢å•ã€æ”¯ä»˜ï¼‰ |
| DiscardPolicy                                   | **é™ä¸¢** | å¼‚æ­¥æ—¥å¿—ã€ç›‘æ§ä¸ŠæŠ¥       |
| DiscardOldestPolicy                             | **æ¢æ–°** | å®æ—¶æ¨é€ã€æœ€æ–°çŠ¶æ€       |

## 4.`CompletableFuture` å¦‚ä½•å®ç° **å¼‚å¸¸ä¼ æ’­** å’Œ **è¶…æ—¶æ§åˆ¶**ï¼Ÿ

```java
CompletableFuture<String> result = CompletableFuture
    .supplyAsync(this::riskyTask)           // ä¸šåŠ¡
    .orTimeout(3, TimeUnit.SECONDS)         // è¶…æ—¶
 	.thenApply(r -> r + "ä¸ä¼šæ‰§è¡Œ")
    .exceptionally(ex -> "å…œåº•å€¼");
    .handle((r, ex) -> {                    // ç»Ÿä¸€å¤„ç†
        if (ex instanceof TimeoutException) {
            log.warn("ä»»åŠ¡è¶…æ—¶");
            return "TIMEOUT";
        } else if (ex != null) {
            log.error("ä»»åŠ¡å¼‚å¸¸", ex);
            return "ERROR";
        }
        return r;
    })
    .whenComplete((r, ex) -> {              // ç›‘æ§
        if (ex == null) metric.success();
        else metric.fail();
    });
```



é¢è¯•å®˜ï¼ŒCompletableFuture çš„å¼‚å¸¸ä¼ æ’­å’Œè¶…æ—¶æ§åˆ¶å¦‚ä¸‹ï¼š

1. **å¼‚å¸¸ä¼ æ’­**ï¼š
   - `exceptionally`ï¼šæ•è·å¹¶è¿”å›é»˜è®¤å€¼
   - `handle`ï¼šæœ€æ¨èï¼ŒåŒå‚æ•°å¤„ç†ç»“æœå’Œå¼‚å¸¸
   - `whenComplete`ï¼šå‰¯ä½œç”¨ï¼Œä¸æ”¹å˜å€¼

2. **è¶…æ—¶æ§åˆ¶**ï¼š
   - JDK9+ï¼š`orTimeout` æŠ› `TimeoutException`ï¼Œ`completeOnTimeout` å¡«å……é»˜è®¤å€¼
   - JDK8ï¼šç”¨ `ScheduledExecutor` + `applyToEither` æ‰‹åŠ¨å®ç°

3. **ç”Ÿäº§å®è·µ**ï¼š
   - ç»Ÿä¸€ç”¨ `handle` æ•è·è¶…æ—¶å’Œä¸šåŠ¡å¼‚å¸¸
   - è¶…æ—¶åå»ºè®® `cancel(true)` ç»ˆæ­¢ä»»åŠ¡
   - é…åˆç›‘æ§æŒ‡æ ‡ï¼ˆå¦‚ Prometheusï¼‰

ä¸¾ä¾‹ï¼šå¼‚æ­¥ RPC è°ƒç”¨ï¼Œ3 ç§’è¶…æ—¶ï¼Œé™çº§è¿”å›ç¼“å­˜ã€‚

---

## äºŒã€Spring Boot å¾®æœåŠ¡å®æˆ˜ï¼ˆå¤§å‚æ ‡é…ï¼‰

| ç¼–å· | é—®é¢˜                                                         | è€ƒå¯Ÿç‚¹               | å¤§å‚å‡ºé¢˜æ¦‚ç‡    | ç­”æ¡ˆæ¡†æ¶                                                     |
| ---- | ------------------------------------------------------------ | -------------------- | --------------- | ------------------------------------------------------------ |
| 6    | Spring Boot å¯åŠ¨è¿‡ç¨‹ä¸­ï¼Œ`@ConditionalOnMissingBean` æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ | è‡ªåŠ¨è£…é…ã€æ¡ä»¶è£…é…   | é˜¿é‡Œ 4æ˜Ÿ        | @ConditionalOnMissingBean æ˜¯ Spring Boot Auto-Configuration çš„æ ¸å¿ƒæ¡ä»¶æ³¨è§£ï¼Œåœ¨ Bean å®šä¹‰é˜¶æ®µåˆ¤æ–­å®¹å™¨ä¸­æ˜¯å¦å·²ç»å­˜åœ¨åŒç±»å‹ï¼ˆæˆ–åŒåï¼‰çš„ Beanï¼Œä¸å­˜åœ¨æ‰æ³¨å†Œå½“å‰è‡ªåŠ¨é…ç½®çš„ Beanã€‚ |
| 7    | å¦‚ä½•åœ¨ Spring Boot ä¸­å®ç° **æ¥å£å¹‚ç­‰æ€§**ï¼Ÿæ”¯æŒé«˜å¹¶å‘é‡å¤æäº¤ | åˆ†å¸ƒå¼ç³»ç»Ÿã€å¹‚ç­‰ä»¤ç‰Œ | å­—èŠ‚/å°çº¢ä¹¦ 5æ˜Ÿ | Redis + Tokenï¼ˆç”Ÿæˆ â†’ æäº¤ â†’ åˆ é™¤ï¼‰ï¼›Lua è„šæœ¬ä¿è¯åŸå­æ€§      |
| 8    | Spring Cloud Gateway å¦‚ä½•å®ç° **å…¨å±€é™æµ**ï¼Ÿæ”¯æŒä»¤ç‰Œæ¡¶ï¼Ÿ     | ç½‘å…³ã€é™æµ           | å¿«æ‰‹/é˜¿é‡Œ 4æ˜Ÿ   | `RequestRateLimiter` + Redis + `RedisRateLimiter`ï¼›æ”¯æŒä»¤ç‰Œæ¡¶ |
| 9    | å¦‚ä½•åœ¨ Spring Boot ä¸­ä¼˜é›…å…³é—­çº¿ç¨‹æ± ï¼Ÿé¿å…ä»»åŠ¡ä¸¢å¤±ï¼Ÿ          | åº”ç”¨ç”Ÿå‘½å‘¨æœŸ         | å­—èŠ‚ 4æ˜Ÿ        | ThreadPoolTaskExecutor<br/>   â”œâ”€â”€ CallerRunsPolicy â†’ é˜²ä¸¢å¤±<br/>   â”œâ”€â”€ allowCoreThreadTimeOut â†’ é˜²æ³„æ¼<br/>   â””â”€â”€ prestartAllCoreThreads â†’ é˜²å†·å¯åŠ¨<br/>SmartLifecycle<br/>   â”œâ”€â”€ shutdown() â†’ åœæ–°ä»»åŠ¡<br/>   â””â”€â”€ awaitTermination() â†’ ç­‰è€ä»»åŠ¡<br/>K8s preStop â†’ è§¦å‘å…³é—­ |
| 10   | Spring Boot Actuator å¦‚ä½•è‡ªå®šä¹‰å¥åº·æ£€æŸ¥ï¼Ÿç›‘æ§ AI Agent æœåŠ¡ï¼Ÿ | å¯è§‚æµ‹æ€§             | å°çº¢ä¹¦ 3æ˜Ÿ      | å®ç° `HealthIndicator`ï¼›æ£€æŸ¥æ¨¡å‹åŠ è½½çŠ¶æ€ã€æ¨ç†å»¶è¿Ÿ           |



## 6.@ConditionalOnMissingBean

```text
1. Spring Boot å¯åŠ¨ â†’ æ‰«æ @SpringBootApplication
2. åŠ è½½ META-INF/spring.factories â†’ æ‰¾åˆ°æ‰€æœ‰ *AutoConfiguration ç±»
3. æŒ‰ @AutoConfiguration(before/after) æ’åºåé€ä¸ªå¤„ç†
4. é‡åˆ° @ConditionalOnMissingBean â†’ è¿›å…¥ Condition è¯„ä¼°
   â”œâ”€ OnBeanCondition.getMatchOutcome()
   â”œâ”€ éå† BeanFactoryï¼Œæ£€æŸ¥ type / name æ˜¯å¦å·²å­˜åœ¨
   â””â”€ è‹¥ä¸å­˜åœ¨ â†’ MATCHï¼ˆæ³¨å†Œè¯¥ Beanï¼‰
      è‹¥å·²å­˜åœ¨ â†’ NO_MATCHï¼ˆè·³è¿‡è¯¥ @Bean æ–¹æ³•ï¼‰
```



```java
@Configuration
@ConditionalOnClass(RedisOperations.class)
public class RedisAutoConfiguration {

    @Bean
    @ConditionalOnMissingBean   // ç”¨æˆ·è‡ªå®šä¹‰ RedisTemplate å°±ä¸ä¼šåˆ›å»º
    public RedisTemplate<Object, Object> redisTemplate(RedisConnectionFactory factory) {
        return new RedisTemplate<>();
    }
}
```



## 7. å¦‚ä½•å®ç°æ¥å£å¹‚ç­‰æ€§ï¼Ÿæ”¯æŒé«˜å¹¶å‘é‡å¤æäº¤

1. å‰ç«¯è¯·æ±‚æ¥å£->è·å–token

2. æäº¤ä¸šåŠ¡

   1. Header: Idempotent-Token: xxx

3.  åç«¯ï¼š

      â”œâ”€ Redis SET token "processing" NX EX 30  ï¼ˆé˜²é‡ï¼‰

      â”œâ”€ æ‰§è¡Œä¸šåŠ¡ï¼ˆæ’å…¥è®¢å•ã€æ‰£åº“å­˜ï¼‰

      â””â”€ æˆåŠŸå SET token "success" EX 3600

4. é‡å¤è¯·æ±‚ â†’ Redis å·²å­˜åœ¨ â†’ è¿”å›â€œè¯·å‹¿é‡å¤æäº¤â€

| ä¼˜åŒ–ç‚¹              | å®ç°æ–¹å¼                                                     |
| ------------------- | ------------------------------------------------------------ |
| **1. åŸå­æ€§**       | `SET key value NX EX` â†’ Redis å•å‘½ä»¤åŸå­                     |
| **2. é˜²é›ªå´©**       | ä»¤ç‰Œæœ‰æ•ˆæœŸçŸ­ï¼ˆ30sï¼‰ï¼ŒæˆåŠŸåå»¶é•¿ï¼ˆ1hï¼‰                        |
| **3. ç»“æœç¼“å­˜**     | æˆåŠŸå `SET token_result:xxx -> JSON(result)`ï¼Œé‡å¤è¯·æ±‚ç›´æ¥è¿”å› |
| **4. é˜²é‡æ”¾æ”»å‡»**   | ç»“åˆç”¨æˆ· ID + IPï¼š`token:userId:ip`                          |
| **5. è¶…æ—¶è‡ªåŠ¨é‡Šæ”¾** | `EX 30` é˜²æ­¢æ­»é”                                             |

| è¿½é—®                                  | å›ç­”                                                         |
| ------------------------------------- | ------------------------------------------------------------ |
| **1. ä¸šåŠ¡æ‰§è¡Œæ…¢ï¼Œ30s è¶…æ—¶äº†æ€ä¹ˆåŠï¼Ÿ** | è¶…æ—¶åä»¤ç‰Œè‡ªåŠ¨è¿‡æœŸï¼Œå…è®¸é‡è¯•ï¼›æˆåŠŸå `SET success EX 1h`ï¼Œé¿å…é‡å¤æ‰§è¡Œ |
| **2. å¦‚ä½•è¿”å›ä¸Šæ¬¡ç»“æœï¼Ÿ**             | æˆåŠŸåç¼“å­˜ `token_result:xxx -> JSON`ï¼Œé‡å¤è¯·æ±‚ `GET` è¿”å›   |
| **3. å¹¶å‘ 1000 æ¬¡é‡å¤æäº¤ä¼šæ€æ ·ï¼Ÿ**   | åªæœ‰ç¬¬ä¸€æ¬¡æ‹¿åˆ°é”ï¼Œå…¶ä»– 999 æ¬¡ç›´æ¥è¿”å›â€œè¯·å‹¿é‡å¤æäº¤â€ï¼Œ**é›¶ä¸šåŠ¡å½±å“** |
| **4. æ”¯æŒ SpEL åŠ¨æ€ key å—ï¼Ÿ**        | é€šè¿‡ Spring SpELï¼ˆSpring Expression Languageï¼‰ åŠ¨æ€è§£ææ–¹æ³•å‚æ•°ã€æ³¨è§£å±æ€§ã€Header ç­‰ï¼Œç”Ÿæˆ ä¸šåŠ¡å”¯ä¸€ Keyï¼Œå®Œç¾é€‚é…è®¢å•å·ã€ç”¨æˆ·ID ç­‰åœºæ™¯ã€‚<br />æ”¯æŒï¼Œå¦‚ `@Idempotent(key = "#request.orderId")`ï¼Œç»“åˆ `SpelExpressionParser` |
| **5. å¦‚ä½•é˜²æ­¢æ¶æ„åˆ·æ¥å£ï¼Ÿ**           | ç»“åˆ **IP é™æµï¼ˆGuava RateLimiterï¼‰ + ç™»å½•æ ¡éªŒ + Token é˜²é‡æ”¾** |

### **7.1å¦‚ä½•é˜²æ­¢æ¶æ„åˆ·æ¥å£ï¼Ÿ**

#### 1. ç½‘å…³å±‚ï¼šæµé‡å…¥å£çš„ç¬¬ä¸€é“é˜²çº¿

è¿™æ˜¯æœ€å‰ç½®çš„é˜²çº¿ï¼Œä¸»è¦ç›®æ ‡æ˜¯æ‹¦æˆªæ‰å¤§éƒ¨åˆ†â€œç®€å•ç²—æš´â€çš„æœºå™¨æµé‡ã€‚

- **IP é™æµï¼š** è¿™é€šå¸¸åœ¨ Nginxã€Spring Cloud Gateway æˆ– Kong è¿™æ ·çš„ç½‘å…³ä¸Šå®ç°ã€‚
- **WAF (Web åº”ç”¨é˜²ç«å¢™)ï¼š** éƒ¨ç½² WAF æ¥è‡ªåŠ¨è¯†åˆ«å’Œæ‹¦æˆªå·²çŸ¥çš„æ”»å‡»æ¨¡å¼ï¼Œæ¯”å¦‚ SQL æ³¨å…¥ã€XSSã€DDoS æ”»å‡»å’Œå¸¸è§çš„çˆ¬è™« User-Agentã€‚
- **IP é»‘ç™½åå•ï¼š** ç›´æ¥åœ¨ç½‘å…³å±‚æ‹’ç»è®¿é—®ã€‚

#### 2. åº”ç”¨å±‚ï¼šç²¾ç»†åŒ–çš„ä¸šåŠ¡é˜²çº¿

å½“æµé‡ç©¿é€ç½‘å…³åï¼Œåº”ç”¨å±‚éœ€è¦æ ¹æ®ä¸šåŠ¡é€»è¾‘è¿›è¡Œæ›´ç²¾ç»†çš„æ§åˆ¶ã€‚

- **ä¸šåŠ¡é™æµï¼ˆç”¨æˆ·çº§é™æµï¼‰**
- **æŠ€æœ¯å®ç°ï¼š** åœ¨ Java åç«¯ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨ **Redis é…åˆ Lua è„šæœ¬**ï¼ˆä¿è¯åŸå­æ€§ï¼‰æ¥å®ç°åˆ†å¸ƒå¼çš„é™æµç®—æ³•ï¼Œå¦‚ä»¤ç‰Œæ¡¶æˆ–æ¼æ¡¶ã€‚åœ¨ Spring Boot ä¸­ï¼Œä¼šé€šè¿‡ **AOP åˆ‡é¢** å°†é™æµé€»è¾‘ä½œç”¨äºéœ€è¦ä¿æŠ¤çš„ Controller æ–¹æ³•ä¸Šï¼Œä¿æŒä¸šåŠ¡ä»£ç çš„æ•´æ´ã€‚
- **äººæœºæ ¡éªŒ (CAPTCHA)ï¼š** å½“ç³»ç»Ÿæ£€æµ‹åˆ°è¯·æ±‚é¢‘ç‡å¼‚å¸¸æ—¶ï¼Œæˆ‘ä»¬ä¼š**åŠ¨æ€å¼¹å‡ºéªŒè¯ç **ï¼ˆå¦‚æ»‘å—ã€ç‚¹é€‰ï¼‰æ¥å¼ºåˆ¶è¿›è¡Œäººæœºè¯†åˆ«ã€‚
- **æ¥å£è®¤è¯ï¼š** ä¸¥æ ¼çš„**è®¤è¯é‰´key**ã€‚ä½¿ç”¨ JWT Token éªŒè¯ç”¨æˆ·èº«ä»½

#### 3. é£æ§/æ•°æ®å±‚ï¼šæ™ºèƒ½åŒ–çš„ä¸»åŠ¨é˜²çº¿

è¿™æ˜¯æœ€é«˜çº§çš„é˜²çº¿ï¼Œå®ƒä¸æ˜¯åŸºäºå›ºå®šçš„â€œé˜ˆå€¼â€ï¼Œè€Œæ˜¯åŸºäºâ€œè¡Œä¸ºæ¨¡å¼â€ã€‚

- **å¼‚å¸¸è¡Œä¸ºåˆ†æï¼š** æˆ‘ä»¬ä¼šæ”¶é›†ç”¨æˆ·çš„è¡Œä¸ºæ—¥å¿—ï¼ˆå¦‚IPåœ°å€ã€è®¾å¤‡æŒ‡çº¹ã€è¯·æ±‚åºåˆ—ï¼‰ï¼Œé€šè¿‡é£æ§ç³»ç»Ÿæˆ– AI æ¨¡å‹è¿›è¡Œåˆ†æã€‚
- **è¯†åˆ«å¼‚å¸¸æ¨¡å¼ï¼š** æ¯”å¦‚ï¼Œä¸€ä¸ªè¯·æ±‚åœ¨æ³¨å†Œå 1 ç§’å†…å°±å‘èµ·äº†æ”¯ä»˜
- **åŠ¨æ€å¤„ç½®ï¼š** å¯¹äºè¯†åˆ«å‡ºçš„é«˜é£é™©è¯·æ±‚ï¼Œé£æ§ç³»ç»Ÿå¯ä»¥åŠ¨æ€é‡‡å–æªæ–½ï¼Œæ¯”å¦‚**ä¸´æ—¶å†»ç»“è´¦æˆ·ã€å¼ºåˆ¶è¦æ±‚äºŒæ¬¡éªŒè¯ï¼ˆå¦‚çŸ­ä¿¡éªŒè¯ç ï¼‰ï¼Œæˆ–è€…ç›´æ¥æ‹’ç»**æœ¬æ¬¡æ“ä½œã€‚

### 8.Spring Cloud Gateway å¦‚ä½•å®ç° **å…¨å±€é™æµ**ï¼Ÿæ”¯æŒä»¤ç‰Œæ¡¶ï¼Ÿ

#### 1.**é…ç½®å…¨å±€é™æµè§„åˆ™**

#### 2.**å®ç°é™æµé”®è§£æå™¨ï¼ˆKeyResolverï¼‰**

å®šä¹‰é™æµçš„ç»´åº¦ï¼ˆå¦‚æŒ‰ç”¨æˆ·ã€IPã€è·¯å¾„ç­‰ï¼‰ï¼š

```java
@Bean
public KeyResolver userKeyResolver() {
    // æŒ‰è¯·æ±‚IPé™æµï¼ˆæ¨èï¼‰
    return exchange -> Mono.just(
        exchange.getRequest().getRemoteAddress().getAddress().getHostAddress()
    );
    // å…¶ä»–å¸¸è§æ–¹å¼ï¼š
    // æŒ‰ç”¨æˆ·ID: return exchange -> Mono.just(exchange.getRequest().getHeaders().getFirst("userId"));
    // æŒ‰è·¯å¾„:   return exchange -> Mono.just(exchange.getRequest().getPath().toString());
}
```

#### 3.ä»¤ç‰Œæ¡¶

**ç®—æ³•è¡Œä¸º**ï¼š

- â€¢æ¯æ¬¡è¯·æ±‚ä»æ¡¶ä¸­å–ä»¤ç‰Œï¼ˆ`requestedTokens`ï¼‰
- â€¢ä»¤ç‰ŒæŒ‰`replenishRate`é€Ÿç‡æŒç»­è¡¥å……
- â€¢å½“`burstCapacity`è¢«è€—å°½æ—¶è¿”å›HTTP 429ï¼ˆToo Many Requestsï¼‰

### 9.å¦‚ä½•åœ¨ Spring Boot ä¸­ä¼˜é›…å…³é—­çº¿ç¨‹æ± ï¼Ÿé¿å…ä»»åŠ¡ä¸¢å¤±ï¼Ÿ

```
Spring å®¹å™¨å…³é—­
   â†“
SmartLifecycle.stop() â†’ è§¦å‘ shutdown
   â†“
executor.shutdown() â†’ ä¸å†æ¥å—æ–°ä»»åŠ¡
   â†“
executor.awaitTermination(timeout) â†’ ç­‰å¾…æ‰§è¡Œä¸­ä»»åŠ¡å®Œæˆ
   â†“
JVM æ­£å¸¸é€€å‡º
```

| æœºåˆ¶                      | å®ç°                               | æ•ˆæœ           |
| ------------------------- | ---------------------------------- | -------------- |
| **1. CallerRunsPolicy**   | é˜Ÿåˆ—æ»¡æ—¶ï¼Œè°ƒç”¨çº¿ç¨‹æ‰§è¡Œä»»åŠ¡         | **ä¸ä¸¢ä»»åŠ¡**   |
| **2. shutdown()**         | ä¸å†æ¥å—æ–°ä»»åŠ¡ï¼Œç­‰å¾…æ‰§è¡Œä¸­ä»»åŠ¡å®Œæˆ | **ä¸ä¸­æ–­ä»»åŠ¡** |
| **3. awaitTermination()** | é˜»å¡ç­‰å¾…ä»»åŠ¡ç»“æŸ                   | **ä¼˜é›…é€€å‡º**   |

```
ThreadPoolTaskExecutor
   â”œâ”€â”€ CallerRunsPolicy â†’ é˜²ä¸¢å¤±
   â”œâ”€â”€ allowCoreThreadTimeOut â†’ é˜²æ³„æ¼
   â””â”€â”€ prestartAllCoreThreads â†’ é˜²å†·å¯åŠ¨
SmartLifecycle
   â”œâ”€â”€ shutdown() â†’ åœæ–°ä»»åŠ¡
   â””â”€â”€ awaitTermination() â†’ ç­‰è€ä»»åŠ¡
K8s preStop â†’ è§¦å‘å…³é—­
```

> **prestartAllCoreThreads() æ˜¯â€œçº¿ç¨‹æ± é¢„çƒ­â€ï¼Œåœ¨åˆå§‹åŒ–æ—¶ç«‹å³åˆ›å»ºæ‰€æœ‰æ ¸å¿ƒçº¿ç¨‹ï¼Œé¿å…ç¬¬ä¸€æ¬¡ä»»åŠ¡æäº¤æ—¶çš„çº¿ç¨‹åˆ›å»ºå»¶è¿Ÿï¼Œæå‡å“åº”é€Ÿåº¦ã€‚**

### 10.Spring Boot Actuator å¦‚ä½•è‡ªå®šä¹‰å¥åº·æ£€æŸ¥ï¼Ÿç›‘æ§ AI Agent æœåŠ¡ï¼Ÿ

### ä¸€ã€åŸºæœ¬åŸç†

Spring Boot Actuator æä¾›äº† `/actuator/health` ç«¯ç‚¹ï¼Œç”¨äºç›‘æ§åº”ç”¨åŠå…¶ä¾èµ–ï¼ˆå¦‚æ•°æ®åº“ã€Redisã€å¤–éƒ¨ API ç­‰ï¼‰çš„å¥åº·çŠ¶å†µã€‚
 é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒåŒ…å«å†…ç½®çš„å¥åº·æŒ‡æ ‡ï¼ˆå¦‚ `DiskSpaceHealthIndicator`, `DataSourceHealthIndicator`ï¼‰ã€‚
 æˆ‘ä»¬å¯ä»¥æ‰©å±•å®ƒä»¥ç›‘æ§è‡ªå®šä¹‰æœåŠ¡ï¼Œä¾‹å¦‚ **AI Agent æœåŠ¡**ã€‚

### äºŒã€è‡ªå®šä¹‰å¥åº·æ£€æŸ¥æ­¥éª¤

#### âœ… 1. åˆ›å»ºè‡ªå®šä¹‰ HealthIndicator

å‡è®¾æˆ‘ä»¬è¦ç›‘æ§ä¸€ä¸ª AI Agent æœåŠ¡çš„å¯ç”¨æ€§ï¼Œæ¯”å¦‚å®ƒæš´éœ²äº†ä¸€ä¸ª `/status` çš„ APIã€‚

```
import org.springframework.boot.actuate.health.Health;
import org.springframework.boot.actuate.health.HealthIndicator;
import org.springframework.stereotype.Component;
import org.springframework.web.client.RestTemplate;

@Component
public class AIAgentHealthIndicator implements HealthIndicator {

    private final RestTemplate restTemplate = new RestTemplate();
    private static final String AGENT_URL = "http://localhost:8081/agent/status";

    @Override
    public Health health() {
        try {
            String response = restTemplate.getForObject(AGENT_URL, String.class);
            if (response != null && response.contains("OK")) {
                return Health.up()
                        .withDetail("AI Agent", "Available")
                        .withDetail("endpoint", AGENT_URL)
                        .build();
            } else {
                return Health.down()
                        .withDetail("AI Agent", "Unresponsive or error")
                        .build();
            }
        } catch (Exception e) {
            return Health.down(e)
                    .withDetail("AI Agent", "Connection failed")
                    .build();
        }
    }
}
```

ğŸ“˜ **è¯´æ˜ï¼š**

- `Health.up()` â†’ æœåŠ¡å¥åº·
- `Health.down()` â†’ æœåŠ¡ä¸å¯ç”¨
- ä½ å¯ä»¥åœ¨ `withDetail()` ä¸­æ·»åŠ æ›´å¤šå…ƒæ•°æ®ï¼ˆä¾‹å¦‚æ¨¡å‹ç‰ˆæœ¬ã€å»¶è¿Ÿã€QPS ç­‰ï¼‰

------

#### âœ… 2. å¯ç”¨ Actuator å¹¶æš´éœ²å¥åº·ç«¯ç‚¹

åœ¨ `application.yml` ä¸­é…ç½®ï¼š

```
management:
  endpoints:
    web:
      exposure:
        include: health, info, metrics
  endpoint:
    health:
      show-details: always
```

ç„¶åè®¿é—®ï¼š

```
GET http://localhost:8080/actuator/health
```

ç»“æœç¤ºä¾‹ï¼š

```
{
  "status": "UP",
  "components": {
    "diskSpace": {
      "status": "UP"
    },
    "db": {
      "status": "UP"
    },
    "aiAgent": {
      "status": "UP",
      "details": {
        "AI Agent": "Available",
        "endpoint": "http://localhost:8081/agent/status"
      }
    }
  }
}
```

### ä¸‰ã€ç›‘æ§ AI Agent çš„è¿›é˜¶ç”¨æ³•

å¦‚æœä½ çš„ AI Agent æœåŠ¡æ˜¯ä¸€ä¸ª **LLM Agent æœåŠ¡**ï¼ˆä¾‹å¦‚è°ƒç”¨ OpenAI æˆ–æœ¬åœ°æ¨¡å‹ï¼‰ï¼Œä½ å¯ä»¥ï¼š

1. åœ¨å¥åº·æ£€æŸ¥ä¸­å¢åŠ ï¼š
   - **å“åº”æ—¶é—´ç›‘æ§**ï¼ˆé€šè¿‡ `StopWatch`ï¼‰
   - **æ¨¡å‹çŠ¶æ€æ£€æŸ¥**ï¼ˆå¦‚æ¨¡å‹åŠ è½½æ˜¯å¦å®Œæˆï¼‰
   - **Token ä½¿ç”¨ç‡ã€GPU å†…å­˜å ç”¨**ï¼ˆä» Agent metrics è·å–ï¼‰

ç¤ºä¾‹ï¼š

```
@Override
public Health health() {
    long start = System.currentTimeMillis();
    try {
        AgentStatus status = restTemplate.getForObject(AGENT_URL, AgentStatus.class);
        long latency = System.currentTimeMillis() - start;

        if (status != null && status.isReady()) {
            return Health.up()
                    .withDetail("latency", latency + "ms")
                    .withDetail("model", status.getModelName())
                    .withDetail("load", status.getGpuLoad() + "%")
                    .build();
        } else {
            return Health.down()
                    .withDetail("AI Agent", "Not ready")
                    .build();
        }
    } catch (Exception e) {
        return Health.down(e)
                .withDetail("error", e.getMessage())
                .build();
    }
}
```

------

### å››ã€è§£ææ€»ç»“ï¼ˆé¢è¯•å®˜è§†è§’ï¼‰

| è€ƒå¯Ÿç‚¹            | é¢è¯•è€…å›ç­”è¦ç‚¹                              |
| ----------------- | ------------------------------------------- |
| **Actuator åŸºç¡€** | æ¸…æ¥šçŸ¥é“ `/actuator/health` çš„ç”¨é€”          |
| **æ‰©å±•æœºåˆ¶**      | çŸ¥é“é€šè¿‡å®ç° `HealthIndicator` æ¥è‡ªå®šä¹‰æ£€æŸ¥ |
| **å®è·µèƒ½åŠ›**      | èƒ½ç»™å‡ºå…·ä½“ä»£ç å®ç°                          |
| **AI åœºæ™¯ç†è§£**   | èƒ½å°†å¥åº·æ£€æŸ¥ä¸ä¸šåŠ¡ï¼ˆAI Agent çŠ¶æ€ï¼‰ç»“åˆ     |
| **ç›‘æ§æ„è¯†**      | èƒ½å»¶ä¼¸åˆ°å»¶è¿Ÿã€èµ„æºåˆ©ç”¨ç‡ã€å¤–éƒ¨ä¾èµ–çŠ¶æ€ç›‘æ§  |

---

## ä¸‰ã€ç³»ç»Ÿè®¾è®¡ï¼ˆå¤§å‚æ ¸å¿ƒï¼‰

| ç¼–å· | é—®é¢˜                                                 | è€ƒå¯Ÿç‚¹               | å¤§å‚å‡ºé¢˜æ¦‚ç‡    | ç­”æ¡ˆæ¡†æ¶                                                     |
| ---- | ---------------------------------------------------- | -------------------- | --------------- | ------------------------------------------------------------ |
| 11   | è®¾è®¡ä¸€ä¸ª **æ”¯æŒ 10w QPS çš„çŸ­è§†é¢‘æ¨èæ¥å£**           | é«˜å¹¶å‘ã€æ¨èç³»ç»Ÿ     | å­—èŠ‚/å¿«æ‰‹ 5æ˜Ÿ   | CDN + Edge Cache â†’ API Gateway â†’ æ¨èæœåŠ¡ï¼ˆå¤šçº§ç¼“å­˜ï¼šRedis + LocalCacheï¼‰â†’ ç‰¹å¾æœåŠ¡ â†’ æ¨¡å‹æ¨ç† â†’ ç»“æœåˆå¹¶ |
| 12   | è®¾è®¡ä¸€ä¸ª **AI Agent ä»»åŠ¡ç¼–æ’å¹³å°**ï¼ˆæ”¯æŒå¤šå·¥å…·è°ƒç”¨ï¼‰ | Agent æ¶æ„ã€ä»»åŠ¡è°ƒåº¦ | å­—èŠ‚/é˜¿é‡Œ 5æ˜Ÿ   | ä»»åŠ¡ä¸­å¿ƒï¼ˆKafkaï¼‰â†’ Agent Executorï¼ˆçº¿ç¨‹æ± ï¼‰â†’ Tool Registryï¼ˆSpring Beanï¼‰â†’ ç»“æœèšåˆï¼ˆCompletableFuture.allOfï¼‰ |
| 13   | å¦‚ä½•è®¾è®¡ä¸€ä¸ª **æ”¯æŒåŠ¨æ€æ‰©ç¼©å®¹çš„ AI æ¨ç†æœåŠ¡**ï¼Ÿ      | K8sã€æ¨¡å‹éƒ¨ç½²        | é˜¿é‡Œ/å°çº¢ä¹¦ 4æ˜Ÿ | K8s HPA + Custom Metricsï¼ˆQPS/å»¶è¿Ÿï¼‰ï¼›æ¨¡å‹çƒ­æ›´æ–°ï¼ˆConfigMap + Sidecarï¼‰ |
| 14   | è®¾è®¡ä¸€ä¸ª **å®æ—¶ç‰¹å¾å¹³å°**ï¼Œæ”¯æŒåœ¨çº¿+ç¦»çº¿ç‰¹å¾         | ç‰¹å¾å·¥ç¨‹ã€æµæ‰¹ä¸€ä½“   | å­—èŠ‚ 4æ˜Ÿ        | Kafka â†’ Flinkï¼ˆå®æ—¶ï¼‰â†’ Hudiï¼ˆæ¹–ä»“ï¼‰â†’ Redisï¼ˆåœ¨çº¿æœåŠ¡ï¼‰       |

### 11.è®¾è®¡ä¸€ä¸ª **æ”¯æŒ 10w QPS çš„çŸ­è§†é¢‘æ¨èæ¥å£**

1. **ç½‘å…³å±‚**ï¼šSpring Cloud Gateway + é™æµç†”æ–­
2. **æœåŠ¡å±‚**ï¼šWebFluxå“åº”å¼ç¼–ç¨‹ï¼Œéé˜»å¡IO
3. **ç¼“å­˜ç­–ç•¥**ï¼šå¤šçº§ç¼“å­˜ï¼ˆæœ¬åœ°+Redisé›†ç¾¤ï¼‰
4. **æ•°æ®å±‚**ï¼šè¯»å†™åˆ†ç¦» + åˆ†åº“åˆ†è¡¨
5. **å¼‚æ­¥åŒ–**ï¼šç”¨æˆ·è¡Œä¸ºè®°å½•å¼‚æ­¥å¤„ç†

- â€¢**"ä¸ºä»€ä¹ˆé€‰WebFluxè€Œä¸æ˜¯ä¼ ç»ŸSpring MVCï¼Ÿ"**â†’ "WebFluxçš„å“åº”å¼æ¨¡å‹æ›´é€‚åˆIOå¯†é›†å‹åœºæ™¯ï¼Œçº¿ç¨‹èµ„æºåˆ©ç”¨ç‡æ›´é«˜"
- â€¢**"ç¼“å­˜æ•°æ®ä¸ä¸€è‡´æ€ä¹ˆå¤„ç†ï¼Ÿ"**â†’ "é‡‡ç”¨å»¶æ—¶åŒåˆ ç­–ç•¥ï¼Œç»“åˆæ¶ˆæ¯é˜Ÿåˆ—ä¿è¯æœ€ç»ˆä¸€è‡´æ€§"
- â€¢**"å¦‚ä½•è§£å†³å†·å¯åŠ¨é—®é¢˜ï¼Ÿ"**â†’ "æ–°ç”¨æˆ·é‡‡ç”¨çƒ­é—¨è§†é¢‘+éšæœºæ¨èï¼Œå¿«é€Ÿæ”¶é›†è¡Œä¸ºæ•°æ®"

---

## å››ã€æ•°æ®åº“ä¸ç¼“å­˜ï¼ˆé«˜é¢‘ï¼‰

| ç¼–å· | é—®é¢˜                                                         | è€ƒå¯Ÿç‚¹             | å¤§å‚å‡ºé¢˜æ¦‚ç‡  | ç­”æ¡ˆæ¡†æ¶                                                     |
| ---- | ------------------------------------------------------------ | ------------------ | ------------- | ------------------------------------------------------------ |
| 15   | MySQL ä¸€æ¡ SQL æ‰§è¡Œæ…¢ï¼Œå¦‚ä½•å®šä½ï¼Ÿ`EXPLAIN` çš„ `type` æœ‰å“ªäº›ï¼Ÿ | æ…¢æŸ¥è¯¢ã€æ‰§è¡Œè®¡åˆ’   | æ‰€æœ‰å¤§å‚ 5æ˜Ÿ  | `ALL` < `index` < `range` < `ref` < `eq_ref` < `const`       |
| 16   | Redis å¦‚ä½•å®ç° **åˆ†å¸ƒå¼é”**ï¼Ÿå¦‚ä½•é˜²æ­¢æ­»é”ï¼Ÿ                  | åˆ†å¸ƒå¼é”ã€Redisson | å­—èŠ‚/é˜¿é‡Œ 5æ˜Ÿ | `SET key value NX PX 30000` + éšæœºå€¼ + Lua é‡Šæ”¾ï¼›Redisson çœ‹é—¨ç‹—è‡ªåŠ¨ç»­æœŸ |
| 17   | ç¼“å­˜é›ªå´©å¦‚ä½•è§£å†³ï¼Ÿå¦‚ä½•è®¾ç½®çƒ­ç‚¹ç¼“å­˜æ°¸ä¸è¿‡æœŸï¼Ÿ                 | ç¼“å­˜é«˜å¯ç”¨         | å¿«æ‰‹ 4æ˜Ÿ      | éšæœºè¿‡æœŸ + çƒ­ç‚¹æœ¬åœ°ç¼“å­˜ï¼ˆCaffeineï¼‰+ äº’æ–¥æ›´æ–°                |
| 18   | åˆ†åº“åˆ†è¡¨åå¦‚ä½•åˆ†é¡µæŸ¥è¯¢ï¼Ÿå¦‚ä½•é¿å… ID å†²çªï¼Ÿ                   | åˆ†ç‰‡è·¯ç”±           | é˜¿é‡Œ 4æ˜Ÿ      | ä¸­é—´ä»¶ï¼ˆå¦‚ MyCat/ShardingSphereï¼‰è§£æ SQLï¼›é›ªèŠ±ç®—æ³•ç”Ÿæˆ ID   |

### 15.MySQL ä¸€æ¡ SQL æ‰§è¡Œæ…¢ï¼Œå¦‚ä½•å®šä½ï¼Ÿ`EXPLAIN` çš„ `type` æœ‰å“ªäº›ï¼Ÿ

1. â€¢**å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—**ï¼šè®¾ç½®`long_query_time`ï¼ŒæŠ“å–æ‰§è¡Œç¼“æ…¢çš„SQL

2. â€¢**å®æ—¶ç›‘æ§**ï¼šä½¿ç”¨`SHOW PROCESSLIST`æŸ¥çœ‹å½“å‰æ‰§è¡Œçš„SQL

3. â€¢**æ€§èƒ½åˆ†æ**ï¼šç”¨`SHOW PROFILE`åˆ†æå…·ä½“SQLçš„è€—æ—¶é˜¶æ®µ

4. ```sql
   -- æ­¥éª¤1ï¼šè¯†åˆ«æ…¢SQL
   SELECT * FROM mysql.slow_log 
   WHERE query_time > 5 
   ORDER BY query_time DESC 
   LIMIT 10;
   
   -- æ­¥éª¤2ï¼šä½¿ç”¨EXPLAINåˆ†æ
   EXPLAIN SELECT u.name, o.order_amount 
   FROM users u 
   JOIN orders o ON u.id = o.user_id 
   WHERE u.create_time > '2023-01-01' 
   AND o.status = 'COMPLETED';
   
   -- æ­¥éª¤3ï¼šæ£€æŸ¥ç´¢å¼•æƒ…å†µ
   SHOW INDEX FROM users;
   SHOW INDEX FROM orders;
   
   -- æ­¥éª¤4ï¼šä¼˜åŒ–åéªŒè¯
   -- æ·»åŠ ç´¢å¼•åå†æ¬¡EXPLAIN
   CREATE INDEX idx_user_create_time ON users(create_time);
   CREATE INDEX idx_order_status_user ON orders(status, user_id);
   
   EXPLAIN SELECT ...ï¼ˆå†æ¬¡æ‰§è¡Œåˆ†æï¼‰
   ```

5. **`ALL` < `index` < `range` < `ref` < `eq_ref` < `const`<`system `**

6. **å¸¸è§é—®é¢˜è¯†åˆ«**

   - **å…¨è¡¨æ‰«æ**ï¼š`type=ALL`ï¼Œéœ€è¦æ·»åŠ ç´¢å¼•
   - **ç´¢å¼•å¤±æ•ˆ**ï¼šå¦‚`LIKE '%å‰ç¼€'`ã€å‡½æ•°æ“ä½œå¯¼è‡´ç´¢å¼•å¤±æ•ˆ
   - **JOINä¼˜åŒ–**ï¼šå°è¡¨é©±åŠ¨å¤§è¡¨ï¼Œé¿å…ä¸´æ—¶è¡¨

7. **ä¼˜åŒ–éªŒè¯é˜¶æ®µ**

   - **ç´¢å¼•ä¼˜åŒ–**ï¼šæ·»åŠ ç¼ºå¤±ç´¢å¼•ï¼Œä¼˜åŒ–å¤åˆç´¢å¼•é¡ºåº
   - **SQLé‡å†™**ï¼šä¼˜åŒ–æŸ¥è¯¢é€»è¾‘ï¼Œé¿å…SELECT *
   - **æ•ˆæœéªŒè¯**ï¼šå†æ¬¡ä½¿ç”¨`EXPLAIN`ç¡®è®¤ä¼˜åŒ–æ•ˆæœ

**â€œå¯¹äºMySQLæ…¢SQLé—®é¢˜ï¼Œæˆ‘é€šå¸¸é‡‡ç”¨`ç›‘æ§-åˆ†æ-ä¼˜åŒ–-éªŒè¯`çš„å››æ­¥æ³•ã€‚é¦–å…ˆé€šè¿‡æ…¢æŸ¥è¯¢æ—¥å¿—å®šä½é—®é¢˜SQLï¼Œç„¶åç”¨EXPLAINåˆ†ææ‰§è¡Œè®¡åˆ’ï¼Œé‡ç‚¹å…³æ³¨typeå­—æ®µã€‚typeä»æœ€ä¼˜çš„systemã€conståˆ°æœ€å·®çš„ALLï¼Œæˆ‘çš„ç»éªŒæ˜¯å°†ALLä¼˜åŒ–åˆ°refçº§åˆ«é€šå¸¸èƒ½å¸¦æ¥10å€ä»¥ä¸Šçš„æ€§èƒ½æå‡ã€‚æ¯”å¦‚æ›¾ç»æœ‰ä¸ª3ç§’çš„æŸ¥è¯¢ï¼Œé€šè¿‡æ·»åŠ åˆé€‚çš„ç´¢å¼•ä¼˜åŒ–åˆ°äº†0.1ç§’ã€‚â€**

**é¢è¯•å®˜**ï¼šâ€è¯´è¯´ä½ åœ¨type=indexå’Œtype=rangeçš„åŒºåˆ«ï¼Ÿâ€

**å›ç­”**ï¼šâ€`index`æ˜¯å…¨ç´¢å¼•æ‰«æï¼Œè™½ç„¶æ¯”ALLå¥½ï¼Œä½†ä»æœ‰ä¼˜åŒ–ç©ºé—´ï¼›`range`æ˜¯èŒƒå›´æ‰«æï¼Œé€šå¸¸å‡ºç°åœ¨BETWEENã€INç­‰åœºæ™¯ã€‚åœ¨å®é™…ä¼˜åŒ–ä¸­ï¼Œæˆ‘ä¼šå°½é‡è®©æŸ¥è¯¢è¾¾åˆ°rangeæˆ–æ›´å¥½çš„refçº§åˆ«ã€‚â€

### 16.Redis å¦‚ä½•å®ç° **åˆ†å¸ƒå¼é”**ï¼Ÿå¦‚ä½•é˜²æ­¢æ­»é”ï¼Ÿ


â€Redisåˆ†å¸ƒå¼é”ä¸»è¦é€šè¿‡`SET key value NX EX`å‘½ä»¤å®ç°åŸå­åŠ é”å’Œè¿‡æœŸæ—¶é—´è®¾ç½®ã€‚é˜²æ­¢æ­»é”çš„æ ¸å¿ƒæ˜¯â€‹**â€‹è®¾ç½®åˆç†çš„è¿‡æœŸæ—¶é—´â€‹**â€‹å’Œâ€‹**â€‹ä½¿ç”¨å”¯ä¸€æ ‡è¯†é˜²è¯¯åˆ â€‹**â€‹ã€‚

åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæˆ‘æ¨èä½¿ç”¨Redissonå®¢æˆ·ç«¯ï¼Œå®ƒæä¾›äº†çœ‹é—¨ç‹—è‡ªåŠ¨ç»­æœŸæœºåˆ¶ï¼Œèƒ½å¤Ÿæœ‰æ•ˆé¿å…ä¸šåŠ¡æ‰§è¡Œæ—¶é—´è¶…è¿‡é”è¿‡æœŸæ—¶é—´å¯¼è‡´çš„é”å¤±æ•ˆé—®é¢˜ã€‚

å¯¹äºé«˜å¯ç”¨åœºæ™¯ï¼Œå¯ä»¥é‡‡ç”¨Redlockç®—æ³•åœ¨å¤šä¸ªRediså®ä¾‹ä¸ŠåŒæ—¶åŠ é”ï¼Œè¶…è¿‡åŠæ•°æˆåŠŸæ‰ç®—åŠ é”æˆåŠŸï¼Œè¿™æ ·å¯ä»¥é¿å…å•ç‚¹æ•…éšœã€‚â€

### 17.ç¼“å­˜é›ªå´©å¦‚ä½•è§£å†³ï¼Ÿå¦‚ä½•è®¾ç½®çƒ­ç‚¹ç¼“å­˜æ°¸ä¸è¿‡æœŸï¼Ÿ

**ç¼“å­˜é›ªå´©**æ˜¯æŒ‡åœ¨åŒä¸€æ—¶é—´**å¤§é‡ç¼“å­˜åŒæ—¶å¤±æ•ˆ**ï¼Œå¯¼è‡´æ‰€æœ‰è¯·æ±‚ç›´æ¥æ‰“åˆ°æ•°æ®åº“ï¼Œé€ æˆæ•°æ®åº“ç¬æ—¶å‹åŠ›è¿‡å¤§è€Œå´©æºƒã€‚

1. **è¿‡æœŸæ—¶é—´éšæœºåŒ–**

2. **åŒå±‚ç¼“å­˜ç­–ç•¥**  *æœ¬åœ°ç¼“å­˜ + Redisç¼“å­˜*

3. **ç¼“å­˜æ°¸ä¸è¿‡æœŸ + å¼‚æ­¥æ›´æ–°**

4. **ç†”æ–­é™çº§æœºåˆ¶**

   1. ## **çƒ­ç‚¹ç¼“å­˜æ°¸ä¸è¿‡æœŸæ–¹æ¡ˆ**

      **3.1 ä»€ä¹ˆæ˜¯çƒ­ç‚¹æ•°æ®ï¼Ÿ**

      - â€¢é«˜è®¿é—®é‡çš„æ•°æ®ï¼ˆå¦‚çƒ­é—¨å•†å“ã€å¤´æ¡æ–°é—»ï¼‰
      - â€¢æ•°æ®å˜åŒ–ä¸é¢‘ç¹ï¼Œä½†è¯»å–æå…¶é¢‘ç¹

**ä½ çš„å›ç­”**ï¼š

â€å¯¹äºç¼“å­˜é›ªå´©ï¼Œæˆ‘ä¸»è¦é‡‡ç”¨**åˆ†å±‚é˜²å¾¡ç­–ç•¥**ï¼š

1. 1.**é¢„é˜²å±‚**ï¼šè®¾ç½®éšæœºè¿‡æœŸæ—¶é—´ï¼Œåˆ†æ•£ç¼“å­˜å¤±æ•ˆæ—¶é—´ç‚¹
2. 2.**ä¿æŠ¤å±‚**ï¼šä½¿ç”¨äº’æ–¥é”é˜²æ­¢å¤§é‡è¯·æ±‚åŒæ—¶è®¿é—®æ•°æ®åº“
3. 3.**é™çº§å±‚**ï¼šç†”æ–­æœºåˆ¶å’Œé»˜è®¤æ•°æ®è¿”å›

å¯¹äºçƒ­ç‚¹æ•°æ®æ°¸ä¸è¿‡æœŸï¼Œæˆ‘é‡‡ç”¨**é€»è¾‘è¿‡æœŸæ–¹æ¡ˆ**ï¼š

- â€¢ç¼“å­˜ç‰©ç†ä¸Šæ°¸ä¸è¿‡æœŸï¼Œä½†è®°å½•æ•°æ®ç‰ˆæœ¬å·å’Œæ›´æ–°æ—¶é—´
- â€¢é€šè¿‡å¼‚æ­¥çº¿ç¨‹å®šæœŸæ£€æŸ¥å¹¶æ›´æ–°æ•°æ®
- â€¢ç»“åˆå¤šçº§ç¼“å­˜ï¼Œæœ¬åœ°ç¼“å­˜+Redisæå‡æ€§èƒ½

### 18.åˆ†åº“åˆ†è¡¨åå¦‚ä½•åˆ†é¡µæŸ¥è¯¢ï¼Ÿå¦‚ä½•é¿å… ID å†²çªï¼Ÿ

1. äºŒæ¬¡æŸ¥è¯¢æ³•
   - å…ˆæŸ¥æ»¡è¶³æ¡ä»¶çš„**æ•°æ®ä½ç½®**ï¼Œå†ç²¾å‡†æŸ¥è¯¢**æ•°æ®å†…å®¹**
2. æ¸¸æ ‡åˆ†é¡µæ³•
3. æœç´¢å¼•æ“æ³•ï¼ˆå¤§æ•°æ®é‡æ¨èï¼‰
   1. *ä½¿ç”¨Elasticsearchç­‰æœç´¢å¼•æ“å¤„ç†åˆ†é¡µ*

### 

| æ–¹æ¡ˆ           | ä¼˜ç‚¹                     | ç¼ºç‚¹                   | é€‚ç”¨åœºæ™¯                  |
| :------------- | :----------------------- | :--------------------- | :------------------------ |
| **äºŒæ¬¡æŸ¥è¯¢æ³•** | æ•°æ®å‡†ç¡®ï¼Œå…¼å®¹æ€§å¥½       | æ€§èƒ½è¾ƒå·®ï¼Œéœ€è¦æŸ¥è¯¢ä¸¤æ¬¡ | ä¸­å°æ•°æ®é‡ï¼Œéœ€è¦ç²¾ç¡®æ’åº  |
| **æ¸¸æ ‡åˆ†é¡µæ³•** | æ€§èƒ½æœ€ä¼˜ï¼Œæ— æ·±åº¦åˆ†é¡µé—®é¢˜ | ä¸èƒ½è·³é¡µï¼Œå®ç°å¤æ‚     | ä¸»æµæ–¹æ¡ˆï¼Œé€‚åˆAPP/Webåˆ—è¡¨ |
| **æœç´¢å¼•æ“æ³•** | æ”¯æŒå¤æ‚æŸ¥è¯¢ï¼Œæ€§èƒ½å¥½     | æ•°æ®åŒæ­¥å»¶è¿Ÿï¼Œæ¶æ„å¤æ‚ | å¤§æ•°æ®é‡ï¼Œå¤æ‚æœç´¢æ¡ä»¶    |

**ç”¨äºŒæ¬¡æŸ¥è¯¢æ³•ï¼š**

- â€¢âœ… æ•°æ®åˆ†å¸ƒåœ¨å¤šä¸ªæ•°æ®åº“/è¡¨ä¸­
- â€¢âœ… éœ€è¦ç›´æ¥è·³åˆ°ç¬¬50é¡µã€ç¬¬100é¡µ
- â€¢âœ… æ’åºæ¡ä»¶å¤æ‚ï¼ˆå¤šä¸ªå­—æ®µæ’åºï¼‰

**ç”¨æ¸¸æ ‡åˆ†é¡µæ³•ï¼š**

- â€¢âœ… APPä¸‹æ‹‰åŠ è½½æ›´å¤š
- â€¢âœ… å•è¡¨æˆ–ç®€å•åˆ†ç‰‡
- â€¢âœ… åªéœ€è¦è¿ç»­ç¿»é¡µ

| æ–¹æ¡ˆ          | ä¼˜ç‚¹               | ç¼ºç‚¹                       | é€‚ç”¨åœºæ™¯                  |
| :------------ | :----------------- | :------------------------- | :------------------------ |
| **é›ªèŠ±ç®—æ³•**  | æ€§èƒ½é«˜ï¼Œæ— éœ€ä¸­å¿ƒåŒ– | æ—¶é’Ÿå›æ‹¨é—®é¢˜ï¼Œä¾èµ–æœºå™¨æ—¶é’Ÿ | åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œé«˜å¹¶å‘åœºæ™¯    |
| **å·æ®µæ¨¡å¼**  | è¶‹åŠ¿é€’å¢ï¼Œå¯é¢„æµ‹   | ä¾èµ–æ•°æ®åº“ï¼Œæœ‰æ®µå†…ç©ºæ´     | ä¸­å°ç³»ç»Ÿï¼Œéœ€è¦é¡ºåºID      |
| **Redisç”Ÿæˆ** | ç®€å•é«˜æ•ˆï¼Œæ‰©å±•æ€§å¥½ | ä¾èµ–Rediså¯ç”¨æ€§            | å·²æœ‰Redisç¯å¢ƒï¼Œé«˜å¹¶å‘åœºæ™¯ |

---

## äº”ã€AI Agent å¼€å‘ï¼ˆå¤§å‚æ–°å…´æ–¹å‘ï¼‰

| ç¼–å· | é—®é¢˜                                                         | è€ƒå¯Ÿç‚¹          | å¤§å‚å‡ºé¢˜æ¦‚ç‡    | ç­”æ¡ˆæ¡†æ¶                                                     |
| ---- | ------------------------------------------------------------ | --------------- | --------------- | ------------------------------------------------------------ |
| 19   | å¦‚ä½•åœ¨åç«¯å®ç°ä¸€ä¸ª **RAGï¼ˆRetrieval-Augmented Generationï¼‰Agent**ï¼Ÿ | RAGã€å‘é‡æ•°æ®åº“ | å­—èŠ‚/å°çº¢ä¹¦ 5æ˜Ÿ | ç”¨æˆ·æŸ¥è¯¢ â†’ å‘é‡æ£€ç´¢ï¼ˆMilvus/Qdrantï¼‰â†’ TopK æ–‡æ¡£ â†’ Prompt æ‹¼æ¥ â†’ è°ƒç”¨ LLM â†’ è¿”å› |
| 20   | æ‰‹å†™ï¼šå®ç°ä¸€ä¸ª **Tool Calling Agent**ï¼ˆæ”¯æŒå¤©æ°”æŸ¥è¯¢ + æ•°æ®åº“æŸ¥è¯¢ï¼‰ | Agent å·¥å…·è°ƒç”¨  | å­—èŠ‚ 4æ˜Ÿ        | å®šä¹‰ `Tool` æ¥å£ â†’ æ³¨å†Œåˆ° `ToolRegistry` â†’ LLM è¿”å› JSON â†’ è§£ææ‰§è¡Œ â†’ ç»“æœå›å¡« |
| 21   | å¦‚ä½•å®ç° **Agent çš„è®°å¿†æœºåˆ¶**ï¼Ÿæ”¯æŒçŸ­æœŸ+é•¿æœŸè®°å¿†             | è®°å¿†ç®¡ç†        | é˜¿é‡Œ 3æ˜Ÿ        | çŸ­æœŸï¼šä¼šè¯å†… Listï¼›é•¿æœŸï¼šå‘é‡æ•°æ®åº“å­˜å‚¨ + å¬å›               |
| 22   | Agent è°ƒç”¨å·¥å…·å¤±è´¥å¦‚ä½•é‡è¯•ï¼Ÿå¦‚ä½•è®¾ç½®è¶…æ—¶ï¼Ÿ                   | å®¹é”™æœºåˆ¶        | å¿«æ‰‹ 3æ˜Ÿ        | `CompletableFuture` + `orTimeout` + `exceptionally` é‡è¯•     |
| 23   | å¦‚ä½•ç›‘æ§ Agent çš„ **è°ƒç”¨é“¾è·¯** å’Œ **token æ¶ˆè€—**ï¼Ÿ           | å¯è§‚æµ‹æ€§        | å­—èŠ‚ 4æ˜Ÿ        | OpenTelemetry é“¾è·¯è¿½è¸ªï¼›è®°å½• `prompt_tokens`ã€`completion_tokens` |

### 19.å¦‚ä½•åœ¨åç«¯å®ç°ä¸€ä¸ªRAG - æ¶‰åŠ**æ£€ç´¢ã€å¢å¼ºã€ç”Ÿæˆ**ä¸‰ä¸ªæ ¸å¿ƒç¯èŠ‚

ç”¨æˆ·é—®é¢˜ â†’ å‘é‡æ£€ç´¢ â†’ çŸ¥è¯†å¢å¼º â†’ æç¤ºè¯æ„å»º â†’ LLMç”Ÿæˆ â†’ è¿”å›ç­”æ¡ˆ

1. **æ£€ç´¢æ¨¡å—**
   1. å‘é‡æ•°æ®åº“é…ç½®ï¼ˆå‘é‡æ•°æ®åº“+å¤§æ¨¡å‹ï¼‰
   2. æ–‡æ¡£å¤„ç†å’Œå‘é‡åŒ–
   3. è¯­ä¹‰æ£€ç´¢å®ç°
2. **å¢å¼ºæ¨¡å—**
   1. æç¤ºè¯å·¥ç¨‹
   2. ä¸Šä¸‹æ–‡ä¼˜åŒ–å™¨
3. **ç”Ÿæˆæ¨¡å—**
   1. LLMæœåŠ¡é›†æˆ
4. **é«˜çº§ç‰¹æ€§å®ç°**
   1. å¤šè·¯æ£€ç´¢ä¸é‡æ’åº
   2. è‡ªæˆ‘éªŒè¯å’Œä¿®æ­£



å®ç°RAG Agentçš„å…³é”®è¦ç‚¹ï¼š

1. æ¨¡å—åŒ–è®¾è®¡ï¼šæ£€ç´¢ã€å¢å¼ºã€ç”Ÿæˆä¸‰ä¸ªæ ¸å¿ƒæ¨¡å—åˆ†ç¦»
2. å‘é‡åŒ–æ£€ç´¢ï¼šä½¿ç”¨å‘é‡æ•°æ®åº“å®ç°è¯­ä¹‰æœç´¢
3. æç¤ºè¯å·¥ç¨‹ï¼šç²¾å¿ƒè®¾è®¡æç¤ºè¯æ¨¡æ¿
4. æµå¼å“åº”ï¼šæ”¯æŒå®æ—¶å¯¹è¯ä½“éªŒ
5. ç¼“å­˜ä¼˜åŒ–ï¼šæå‡æ€§èƒ½ï¼Œå‡å°‘LLMè°ƒç”¨æˆæœ¬
6. ç›‘æ§éªŒè¯ï¼šä¿è¯å›ç­”è´¨é‡å’Œç³»ç»Ÿç¨³å®šæ€§

æŠ€æœ¯æ ˆæ¨èï¼š

â€¢ å‘é‡æ•°æ®åº“ï¼šChromaã€Weaviateã€Pinecone

â€¢ åµŒå…¥æ¨¡å‹ï¼šOpenAI Embeddingsã€Sentence-BERT

â€¢ LLMæœåŠ¡ï¼šOpenAI GPTã€Azure OpenAIã€æœ¬åœ°æ¨¡å‹

â€¢ åç«¯æ¡†æ¶ï¼šSpring Bootã€WebFluxï¼ˆæ”¯æŒæµå¼å“åº”ï¼‰



### 20.å®ç°ä¸€ä¸ªtool calling agent

------

## **ğŸ”„ å®Œæ•´æ•°æ®æµç¤ºä¾‹**

### **ç¤ºä¾‹ï¼šå¤„ç†å¤æ‚æŸ¥è¯¢**

**ç”¨æˆ·è¯·æ±‚ï¼š**

```
{
    "message": "æˆ‘æƒ³çŸ¥é“åŒ—äº¬ä»Šå¤©çš„å¤©æ°”ï¼ŒåŒæ—¶æŸ¥çœ‹ç”¨æˆ·12345çš„è®¢å•ç»Ÿè®¡ä¿¡æ¯",
    "sessionId": "sess_789"
}
```

### **æ­¥éª¤1ï¼šæ¨ç†åˆ†æç»“æœ**



```
{
    "reasoning": "ç”¨æˆ·éœ€è¦ä¸¤ä¸ªç‹¬ç«‹ä¿¡æ¯ï¼šå¤©æ°”æ•°æ®å’Œè®¢å•ç»Ÿè®¡",
    "plan": "å¹¶è¡Œè°ƒç”¨å¤©æ°”æŸ¥è¯¢å’Œæ•°æ®åº“æŸ¥è¯¢å·¥å…·",
    "requiredTools": ["get_weather", "query_order_stats"],
    "parameters": {
        "weather": {"city": "åŒ—äº¬", "unit": "C"},
        "order_stats": {"user_id": "12345"}
    }
}
```

### **æ­¥éª¤2ï¼šå¹¶è¡Œå·¥å…·æ‰§è¡Œ**

```
// å·¥å…·1ï¼šå¤©æ°”æŸ¥è¯¢
ToolResult weatherResult = weatherTool.getWeather("åŒ—äº¬", "C");
// ç»“æœ: "åŒ—äº¬: æ™´, æ¸©åº¦25Â°C, æ¹¿åº¦60%"

// å·¥å…·2ï¼šè®¢å•ç»Ÿè®¡æŸ¥è¯¢  
ToolResult orderResult = databaseTool.queryOrderStats("12345");
// ç»“æœ: "æ€»è®¢å•: 15, æ€»é‡‘é¢: ï¿¥8,500, å¹³å‡é‡‘é¢: ï¿¥567"
```

### **æ­¥éª¤3ï¼šLLMæ•´åˆç”Ÿæˆ**

**æç¤ºè¯ï¼š**

```
è¯·æ ¹æ®ä»¥ä¸‹æŸ¥è¯¢ç»“æœç”Ÿæˆå‹å¥½çš„å›ç­”ï¼š

ç”¨æˆ·é—®é¢˜ï¼šæˆ‘æƒ³çŸ¥é“åŒ—äº¬ä»Šå¤©çš„å¤©æ°”ï¼ŒåŒæ—¶æŸ¥çœ‹ç”¨æˆ·12345çš„è®¢å•ç»Ÿè®¡ä¿¡æ¯

æŸ¥è¯¢ç»“æœï¼š
1. å¤©æ°”ä¿¡æ¯ï¼šåŒ—äº¬: æ™´, æ¸©åº¦25Â°C, æ¹¿åº¦60%
2. è®¢å•ç»Ÿè®¡ï¼šæ€»è®¢å•: 15, æ€»é‡‘é¢: ï¿¥8,500, å¹³å‡é‡‘é¢: ï¿¥567

è¯·ç”¨è‡ªç„¶è¯­è¨€æ•´åˆè¿™äº›ä¿¡æ¯ï¼Œç”Ÿæˆå¯¹ç”¨æˆ·å‹å¥½çš„å›ç­”ã€‚
```

**LLMç”Ÿæˆå›ç­”ï¼š**

```
æ ¹æ®æ‚¨çš„æŸ¥è¯¢ï¼Œæˆ‘ä¸ºæ‚¨æ‰¾åˆ°äº†ä»¥ä¸‹ä¿¡æ¯ï¼š

ğŸŒ¤ï¸ **åŒ—äº¬ä»Šå¤©å¤©æ°”**ï¼šæ™´æœ—ï¼Œæ°”æ¸©25æ‘„æ°åº¦ï¼Œæ¹¿åº¦60%ï¼Œæ˜¯ä¸ªå¥½å¤©æ°”ï¼

ğŸ“Š **ç”¨æˆ·12345çš„è®¢å•ç»Ÿè®¡**ï¼š
- æ€»è®¢å•æ•°ï¼š15ç¬”
- è®¢å•æ€»é‡‘é¢ï¼š8,500å…ƒ  
- å¹³å‡æ¯å•é‡‘é¢ï¼š567å…ƒ

å¸Œæœ›è¿™äº›ä¿¡æ¯å¯¹æ‚¨æœ‰å¸®åŠ©ï¼
```

### **æ­¥éª¤4ï¼šæœ€ç»ˆå“åº”**

```
{
    "finalAnswer": "æ ¹æ®æ‚¨çš„æŸ¥è¯¢ï¼Œæˆ‘ä¸ºæ‚¨æ‰¾åˆ°äº†ä»¥ä¸‹ä¿¡æ¯ï¼š\n\nğŸŒ¤ï¸ **åŒ—äº¬ä»Šå¤©å¤©æ°”**ï¼šæ™´æœ—ï¼Œæ°”æ¸©25æ‘„æ°åº¦ï¼Œæ¹¿åº¦60%ï¼Œæ˜¯ä¸ªå¥½å¤©æ°”ï¼\n\nğŸ“Š **ç”¨æˆ·12345çš„è®¢å•ç»Ÿè®¡**ï¼š\n- æ€»è®¢å•æ•°ï¼š15ç¬”\n- è®¢å•æ€»é‡‘é¢ï¼š8,500å…ƒ\n- å¹³å‡æ¯å•é‡‘é¢ï¼š567å…ƒ\n\nå¸Œæœ›è¿™äº›ä¿¡æ¯å¯¹æ‚¨æœ‰å¸®åŠ©ï¼",
    "toolCalls": [
        {
            "toolName": "get_weather",
            "parameters": {"city": "åŒ—äº¬", "unit": "C"}
        },
        {
            "toolName": "query_order_stats", 
            "parameters": {"user_id": "12345"}
        }
    ],
    "toolResults": [
        {
            "success": true,
            "result": "åŒ—äº¬: æ™´, æ¸©åº¦25Â°C, æ¹¿åº¦60%"
        },
        {
            "success": true, 
            "result": "æ€»è®¢å•: 15, æ€»é‡‘é¢: ï¿¥8,500, å¹³å‡é‡‘é¢: ï¿¥567"
        }
    ],
    "processingTime": 1250
}
```

---

## å…­ã€ç®—æ³•ä¸ç¼–ç ï¼ˆç™½æ¿/åœ¨çº¿ IDEï¼‰

| ç¼–å· | é—®é¢˜                                                    | è€ƒå¯Ÿç‚¹         | å¤§å‚å‡ºé¢˜æ¦‚ç‡  | ç­”æ¡ˆæ¡†æ¶                                             |
| ---- | ------------------------------------------------------- | -------------- | ------------- | ---------------------------------------------------- |
| 24   | æ‰‹å†™ï¼šå®ç° **LRU Cache**ï¼ˆæ”¯æŒ O(1) get/putï¼Œçº¿ç¨‹å®‰å…¨ï¼‰ | æ•°æ®ç»“æ„ã€å¹¶å‘ | å­—èŠ‚/é˜¿é‡Œ 5æ˜Ÿ | `ConcurrentHashMap` + åŒå‘é“¾è¡¨ + `ReentrantLock`     |
| 25   | ç»™å®šæ—¥å¿—æ•°ç»„ï¼Œæ‰¾å‡º **å‡ºç°æ¬¡æ•°å‰ K é«˜çš„ IP**             | TopKã€å †       | å¿«æ‰‹ 4æ˜Ÿ      | å°é¡¶å †ï¼ˆ`PriorityQueue`ï¼‰ç»´æŠ¤ K ä¸ªå…ƒç´                |
| 26   | å®ç°ä¸€ä¸ª **æ»‘åŠ¨çª—å£é™æµå™¨**ï¼ˆæ”¯æŒ 1 åˆ†é’Ÿ 100 æ¬¡ï¼‰       | é™æµç®—æ³•       | å­—èŠ‚ 4æ˜Ÿ      | Redis ZSet + Lua è„šæœ¬ï¼›æˆ– `LinkedList` + `Timestamp` |

æ»‘åŠ¨çª—å£

| æ–¹æ¡ˆ                           | ç²¾åº¦           | å†…å­˜ | å¹¶å‘ | åˆ†å¸ƒå¼   | æ¨è     |
| ------------------------------ | -------------- | ---- | ---- | -------- | -------- |
| è®¡æ•°å™¨ï¼ˆå›ºå®šçª—å£ï¼‰             | ä½ï¼ˆè¾¹ç•Œçªåˆºï¼‰ | ä½   | é«˜   | éœ€åŸå­   | ä¸æ¨è   |
| **æ»‘åŠ¨çª—å£ï¼ˆList<Long>ï¼‰**     | é«˜             | é«˜   | ä¸­   | éš¾       | é€‚åˆå•æœº |
| **æ»‘åŠ¨çª—å£æ—¥å¿—ï¼ˆRedis ZSetï¼‰** | é«˜             | ä¸­   | é«˜   | åŸç”Ÿæ”¯æŒ | æ¨è     |
| ä»¤ç‰Œæ¡¶ / æ¼æ¡¶                  | å‡å€¼é™æµ       | ä¸­   | é«˜   | éœ€å®ç°   | é€‚åˆå¹³æ»‘ |

---

## ä¸ƒã€é¡¹ç›®ä¸è½¯æŠ€èƒ½ï¼ˆå¤§å‚çœ‹é‡ï¼‰

| ç¼–å· | é—®é¢˜                                                   | è€ƒå¯Ÿç‚¹             | å¤§å‚å‡ºé¢˜æ¦‚ç‡    | ç­”æ¡ˆæ¡†æ¶                                                     |
| ---- | ------------------------------------------------------ | ------------------ | --------------- | ------------------------------------------------------------ |
| 27   | ä½ å‚ä¸è¿‡çš„ä¸€ä¸ª **AI Agent é¡¹ç›®**ï¼Œä» 0 åˆ° 1 å¦‚ä½•è½åœ°ï¼Ÿ | é¡¹ç›®ç»éªŒã€æ¶æ„è®¾è®¡ | å­—èŠ‚/å°çº¢ä¹¦ 5æ˜Ÿ | éœ€æ±‚ â†’ æŠ€æœ¯é€‰å‹ï¼ˆLangChain vs è‡ªç ”ï¼‰â†’ åŸå‹ â†’ ç°åº¦ â†’ ç›‘æ§ â†’ è¿­ä»£ |
| 28   | é¡¹ç›®ä¸­é‡åˆ°è¿‡ **çº¿ä¸Šäº‹æ•…** å—ï¼Ÿå¦‚ä½•å¤„ç†ï¼Ÿ               | æ•…éšœå¤ç›˜           | æ‰€æœ‰å¤§å‚ 5æ˜Ÿ    | ç°è±¡ â†’ å®šä½ï¼ˆArthasã€SkyWalkingï¼‰â†’ åº”æ€¥ â†’ å¤ç›˜ â†’ é¢„é˜²        |
| 29   | å¦‚ä½•ä¸ **ç®—æ³•å›¢é˜Ÿ** åä½œï¼Ÿå¦‚ä½•å®šä¹‰æ¥å£ï¼Ÿ               | è·¨å›¢é˜Ÿæ²Ÿé€š         | é˜¿é‡Œ 4æ˜Ÿ        | OpenAPI è§„èŒƒï¼›Mock æœåŠ¡ï¼›è”è°ƒæµç¨‹ï¼›ç°åº¦éªŒè¯                  |
| 30   | ä½ å¦‚ä½•å­¦ä¹  **AI Agent** æŠ€æœ¯ï¼Ÿæœ€è¿‘åœ¨å­¦ä»€ä¹ˆï¼Ÿ           | å­¦ä¹ èƒ½åŠ›           | å­—èŠ‚ 4æ˜Ÿ        | é˜…è¯»è®ºæ–‡ï¼ˆReActã€Toolformerï¼‰â†’ å®ç° Demo â†’ åº”ç”¨åˆ°é¡¹ç›®        |

---

## å…«ã€åŠ åˆ†é¢˜ï¼ˆAI Agent + åç«¯èåˆï¼‰

| ç¼–å· | é—®é¢˜                                                         | è€ƒå¯Ÿç‚¹             |
| ---- | ------------------------------------------------------------ | ------------------ |
| 31   | å¦‚ä½•å®ç°ä¸€ä¸ª **å¤š Agent åä½œç³»ç»Ÿ**ï¼ˆå¦‚å®¢æœ + æ¨è Agentï¼‰ï¼Ÿ  | Agent ç¼–æ’         |
| 32   | å¦‚ä½•ç”¨ **Spring Boot + Kafka** å®ç° **å®æ—¶ç”¨æˆ·è¡Œä¸ºç‰¹å¾æµ** ä¾› Agent ä½¿ç”¨ï¼Ÿ | æµå¼è®¡ç®—           |
| 33   | Agent è°ƒç”¨å¤–éƒ¨ API è¶…æ—¶å¦‚ä½•å¤„ç†ï¼Ÿå¦‚ä½•å®ç° **ç†”æ–­**ï¼Ÿ         | å®¹é”™ã€Resilience4j |

---

## æ¨¡æ‹Ÿé¢è¯•æµç¨‹ï¼ˆ45 åˆ†é’Ÿï¼‰

| æ—¶é—´      | ç¯èŠ‚     | å†…å®¹                                                 |
| --------- | -------- | ---------------------------------------------------- |
| 0-5 min   | è‡ªæˆ‘ä»‹ç» | 1åˆ†é’ŸæŠ€æœ¯æ ˆ + 1ä¸ª AI Agent é¡¹ç›®                      |
| 5-20 min  | æŠ€æœ¯æ·±æŒ– | ä»»é€‰ 6-8 é¢˜ï¼ˆè¦†ç›– Javaã€Springã€ç³»ç»Ÿè®¾è®¡ã€AI Agentï¼‰ |
| 20-35 min | ç¼–ç é¢˜   | æ‰‹å†™ LRU æˆ– Tool Calling è§£æé€»è¾‘                    |
| 35-40 min | é¡¹ç›®å¤ç›˜ | è®²ä¸€ä¸ª AI Agent è½åœ°æ¡ˆä¾‹                             |
| 40-45 min | æé—®ç¯èŠ‚ | é—®é¢è¯•å®˜å›¢é˜ŸæŠ€æœ¯æ ˆã€AI Agent åº”ç”¨åœºæ™¯                |

---

## å‡†å¤‡æ¸…å•ï¼ˆå¿…ä¼šï¼‰

| ç±»åˆ«            | å¿…å¤‡æŠ€èƒ½                                           |
| --------------- | -------------------------------------------------- |
| **Java**        | `ConcurrentHashMap` åŸç†ã€`CompletableFuture` ç¼–æ’ |
| **Spring Boot** | è‡ªåŠ¨è£…é…ã€å¼‚æ­¥ã€åˆ†å¸ƒå¼é”ã€é™æµ                     |
| **ç³»ç»Ÿè®¾è®¡**    | æ¨èç³»ç»Ÿã€AI Agent å¹³å°                            |
| **AI Agent**    | RAGã€Tool Callingã€è®°å¿†æœºåˆ¶ã€ç›‘æ§                  |
| **ç¼–ç **        | LRUã€TopKã€é™æµç®—æ³•                                |
| **é¡¹ç›®**        | 1ä¸ª AI Agent è½åœ°æ¡ˆä¾‹ï¼ˆæ•°æ®è¯´è¯ï¼‰                  |

---

## æ¨èèµ„æº

- **AI Agent**ï¼šLangChain å®˜æ–¹æ–‡æ¡£ã€ReAct è®ºæ–‡
- **ç³»ç»Ÿè®¾è®¡**ï¼šå­—èŠ‚è·³åŠ¨æŠ€æœ¯åšå®¢ã€é˜¿é‡Œäº‘å¼€å‘è€…ç¤¾åŒº
- **ç¼–ç **ï¼šLeetCode çƒ­é¢˜ 100ã€å­—èŠ‚é«˜é¢‘é¢˜
- **ç›‘æ§**ï¼šSkyWalkingã€Prometheus + Grafana







ä»¥ä¸‹æ˜¯ä¸º **ã€ŒAIåº”ç”¨æœåŠ¡ç«¯å·¥ç¨‹å¸ˆ - Traeã€** å²—ä½é‡èº«å®šåˆ¶çš„ **30 é“æ¨¡æ‹Ÿé¢è¯•é¢˜**ï¼Œè¦†ç›– **å²—ä½æè¿° + èŒä½è¦æ±‚ + ä¼˜å…ˆé¡¹**ï¼Œåˆ†ä¸º **6 å¤§æ¨¡å—**ï¼Œæ¯é¢˜æ ‡æ³¨ **éš¾åº¦ç­‰çº§** å’Œ **è€ƒå¯Ÿç‚¹**ï¼Œä¾¿äºä½ ç³»ç»Ÿæ€§å‡†å¤‡ã€‚

---

## ä¸€ã€Java åç«¯åŸºç¡€ & ç³»ç»Ÿè®¾è®¡ï¼ˆ5 é¢˜ï¼‰  
> è€ƒå¯Ÿï¼š**åç«¯å¼€å‘èƒ½åŠ›ã€ç³»ç»Ÿè®¾è®¡ã€åˆ†å¸ƒå¼ç³»ç»Ÿ**

| é¢˜å· | é¢˜ç›®                                                         | éš¾åº¦    | è€ƒå¯Ÿç‚¹              |
| ---- | ------------------------------------------------------------ | ------- | ------------------- |
| 1    | è®¾è®¡ä¸€ä¸ªæ”¯æŒ **10w QPS** çš„ AI ä»£ç ç”ŸæˆæœåŠ¡ï¼ŒåŒ…å«è¯·æ±‚å…¥å£ã€æ¨¡å‹è°ƒç”¨ã€ç¼“å­˜ã€é™æµã€é™çº§ï¼Œå¦‚ä½•ä¿è¯ **99.99% å¯ç”¨æ€§**ï¼Ÿ | 4 stars | ç³»ç»Ÿè®¾è®¡ã€é«˜å¹¶å‘    |
| 2    | å¦‚ä½•åœ¨ Spring Boot ä¸­å®ç° **åŠ¨æ€æ¨¡å‹è·¯ç”±**ï¼ˆA/B æµ‹è¯•ä¸åŒ LLMï¼‰ï¼Ÿè¯·å†™å‡ºæ ¸å¿ƒä»£ç ç»“æ„ã€‚ | 3 stars | å¾®æœåŠ¡ã€é…ç½®ä¸­å¿ƒ    |
| 3    | è§£é‡Š **ThreadLocal åœ¨ AI è¯·æ±‚ä¸Šä¸‹æ–‡ä¼ é€’ä¸­çš„ä½œç”¨**ï¼Œå¦‚ä½•é¿å…å†…å­˜æ³„æ¼ï¼Ÿ | 3 stars | Java å¹¶å‘ã€å†…å­˜ç®¡ç† |
| 4    | è®¾è®¡ä¸€ä¸ª **AI ä»»åŠ¡å¼‚æ­¥æ‰§è¡Œæ¡†æ¶**ï¼Œæ”¯æŒä»»åŠ¡æ’é˜Ÿã€é‡è¯•ã€è¶…æ—¶ã€ç»“æœå›è°ƒï¼Œå¦‚ä½•å®ç°ï¼Ÿ | 4 stars | æ¶ˆæ¯é˜Ÿåˆ—ã€å¼‚æ­¥æ¶æ„  |
| 5    | å¦‚ä½•ç”¨ **Redis + Lua** å®ç°ä¸€ä¸ª **AI æ¥å£é™æµå™¨**ï¼ˆæ”¯æŒçªå‘æµé‡ï¼‰ï¼Ÿ | 4 stars | ç¼“å­˜ã€åˆ†å¸ƒå¼é”      |

---

## äºŒã€AI é›†æˆ & LLM æœåŠ¡åŒ–ï¼ˆ6 é¢˜ï¼‰  
> è€ƒå¯Ÿï¼š**æ¨¡å‹é›†æˆã€RAGã€Embeddingã€Prompt å·¥ç¨‹**

| é¢˜å· | é¢˜ç›®                                                         | éš¾åº¦    | è€ƒå¯Ÿç‚¹                 |
| ---- | ------------------------------------------------------------ | ------- | ---------------------- |
| 6    | å¦‚ä½•åœ¨ Java ä¸­ä½¿ç”¨ **ONNX Runtime** åŠ è½½ä¸€ä¸ª **ä»£ç ç”Ÿæˆæ¨¡å‹** å¹¶å®ç° **æµå¼è¾“å‡º**ï¼Ÿ | 4 stars | ONNXã€æµå¼æ¨ç†         |
| 7    | å®ç°ä¸€ä¸ª **RAG çŸ¥è¯†é—®ç­”æœåŠ¡**ï¼ŒåŒ…å«ï¼šå‘é‡åŒ–ã€æ£€ç´¢ã€Prompt æ‹¼æ¥ã€LLM è°ƒç”¨ï¼Œå¦‚ä½•ä¼˜åŒ– **å¬å›ç‡å’Œå»¶è¿Ÿ**ï¼Ÿ | 5 stars | RAGã€å‘é‡æ•°æ®åº“        |
| 8    | å¦‚ä½•è®¾è®¡ **Embedding ç¼“å­˜ç­–ç•¥**ï¼Œé¿å…é‡å¤è®¡ç®—ï¼Ÿæ”¯æŒ **TTL + LRU**ã€‚ | 4 stars | ç¼“å­˜ä¼˜åŒ–ã€å‘é‡åŒ–       |
| 9    | è§£é‡Š **Prompt Template çš„è®¾è®¡åŸåˆ™**ï¼Œå¦‚ä½•åœ¨æœåŠ¡ç«¯å®ç° **å¤šè¯­è¨€ + å¤šåœºæ™¯å¤ç”¨**ï¼Ÿ | 3 stars | Prompt Engineering     |
| 10   | å¦‚ä½•å®ç° **AI Agent çš„å·¥å…·è°ƒç”¨ï¼ˆTool Callingï¼‰**ï¼Ÿä»¥â€œæŸ¥è¯¢æ•°æ®åº“â€ä¸ºä¾‹ï¼Œå†™å‡ºæœåŠ¡ç«¯äº¤äº’æµç¨‹ã€‚ | 5 stars | AI Agentã€å‡½æ•°è°ƒç”¨     |
| 11   | å¦‚ä½•åœ¨ Java ä¸­è°ƒç”¨ **OpenAI / é€šä¹‰åƒé—® API**ï¼Œå®ç° **é‡è¯• + ç†”æ–­ + æŒ‡æ ‡åŸ‹ç‚¹**ï¼Ÿ | 3 stars | API é›†æˆã€Resilience4j |

---

## ä¸‰ã€æ€§èƒ½ä¼˜åŒ– & æˆæœ¬æ§åˆ¶ï¼ˆ5 é¢˜ï¼‰  
> è€ƒå¯Ÿï¼š**ç«¯åˆ°ç«¯æ€§èƒ½ã€æ¨¡å‹æˆæœ¬ã€èµ„æºè°ƒåº¦**

| é¢˜å· | é¢˜ç›®                                                         | éš¾åº¦    | è€ƒå¯Ÿç‚¹           |
| ---- | ------------------------------------------------------------ | ------- | ---------------- |
| 12   | AI IDE ä¸­ä¸€æ¬¡ä»£ç è¡¥å…¨å¹³å‡è€—æ—¶ 800msï¼Œå¦‚ä½•ä¼˜åŒ–åˆ° **< 300ms**ï¼Ÿè¯·åˆ—å‡º 5 ä¸ªä¼˜åŒ–ç‚¹ã€‚ | 4 stars | æ€§èƒ½è°ƒä¼˜         |
| 13   | å¦‚ä½•ç»Ÿè®¡ **å•æ¬¡è¯·æ±‚çš„ Token æˆæœ¬** å¹¶å®ç° **é¢„ç®—å‘Šè­¦**ï¼Ÿ     | 4 stars | æˆæœ¬æ§åˆ¶ã€ç›‘æ§   |
| 14   | è®¾è®¡ä¸€ä¸ª **æ¨¡å‹é¢„çƒ­æœºåˆ¶**ï¼Œé¿å…å†·å¯åŠ¨å»¶è¿Ÿï¼Œå¦‚ä½•åœ¨ K8s ä¸­å®ç°ï¼Ÿ | 4 stars | å®¹å™¨åŒ–ã€å¯åŠ¨ä¼˜åŒ– |
| 15   | å¦‚ä½•å®ç° **å¤šæ¨¡å‹è´Ÿè½½å‡è¡¡**ï¼ˆå¦‚æœ¬åœ°å°æ¨¡å‹ + äº‘ç«¯å¤§æ¨¡å‹ï¼‰ï¼Ÿ   | 4 stars | è·¯ç”±ç­–ç•¥ã€å®¹é”™   |
| 16   | å¦‚ä½•ç”¨ **Prometheus + Grafana** ç›‘æ§ AI æœåŠ¡ **P99 å»¶è¿Ÿã€é”™è¯¯ç‡ã€Token æ¶ˆè€—**ï¼Ÿ | 3 stars | å¯è§‚æµ‹æ€§         |

---

## å››ã€é¡¹ç›®ç†è§£ & ä»£ç åˆ†æï¼ˆ4 é¢˜ï¼‰  
> è€ƒå¯Ÿï¼š**é¡¹ç›®çº§ç†è§£ã€é™æ€åˆ†æã€å¤šæ¨¡æ€**

| é¢˜å· | é¢˜ç›®                                                         | éš¾åº¦    | è€ƒå¯Ÿç‚¹              |
| ---- | ------------------------------------------------------------ | ------- | ------------------- |
| 17   | å¦‚ä½•å®ç° **é¡¹ç›®çº§ä»£ç ç†è§£**ï¼Ÿè¾“å…¥ä¸€ä¸ª Git ä»“åº“ï¼Œè¾“å‡ºâ€œé¡¹ç›®åŠŸèƒ½æ¦‚è¿°â€ï¼ŒæŠ€æœ¯æ–¹æ¡ˆï¼Ÿ | 5 stars | é™æ€åˆ†æã€AST       |
| 18   | å¦‚ä½•ç”¨ **Tree-sitter + Embedding** å®ç° **å‡½æ•°çº§è¯­ä¹‰æœç´¢**ï¼Ÿ | 5 stars | ä»£ç è§£æã€å‘é‡æ£€ç´¢  |
| 19   | å¦‚ä½•æ”¯æŒ **å¤šæ¨¡æ€è¾“å…¥**ï¼ˆä»£ç  + æˆªå›¾ â†’ ç”Ÿæˆæ³¨é‡Šï¼‰ï¼ŸæœåŠ¡ç«¯å¦‚ä½•å¤„ç†ï¼Ÿ | 4 stars | å¤šæ¨¡æ€ã€OCR         |
| 20   | å¦‚ä½•å®ç° **AI PEï¼ˆPair Editingï¼‰**ï¼Ÿå‰ç«¯å…‰æ ‡ç§»åŠ¨ â†’ åç«¯å®æ—¶ç”Ÿæˆå»ºè®®ï¼Œå»¶è¿Ÿè¦æ±‚ï¼Ÿ | 4 stars | å®æ—¶äº¤äº’ã€WebSocket |

---

## äº”ã€äº‘åŸç”Ÿ & DevOpsï¼ˆ5 é¢˜ï¼‰  
> è€ƒå¯Ÿï¼š**K8sã€CI/CDã€è‡ªåŠ¨åŒ–éƒ¨ç½²**

| é¢˜å· | é¢˜ç›®                                                         | éš¾åº¦    | è€ƒå¯Ÿç‚¹               |
| ---- | ------------------------------------------------------------ | ------- | -------------------- |
| 21   | å¦‚ä½•åœ¨ K8s ä¸­å®ç° **AI æ¨¡å‹çš„ç°åº¦å‘å¸ƒ**ï¼Ÿ                    | 4 stars | Istioã€Canary        |
| 22   | è®¾è®¡ä¸€ä¸ª **AI æœåŠ¡ CI/CD æµæ°´çº¿**ï¼ŒåŒ…å«å•å…ƒæµ‹è¯•ã€æ¨¡å‹éªŒè¯ã€æ€§èƒ½å›å½’ã€‚ | 4 stars | GitHub Actionsã€Argo |
| 23   | å¦‚ä½•ç”¨ **Helm + Kustomize** ç®¡ç† AI æœåŠ¡é…ç½®ï¼ˆä¸åŒç¯å¢ƒæ¨¡å‹åˆ‡æ¢ï¼‰ï¼Ÿ | 3 stars | é…ç½®ç®¡ç†             |
| 24   | å¦‚ä½•å®ç° **AI æ¨¡å‹çš„çƒ­æ›´æ–°**ï¼ˆä¸é‡å¯æœåŠ¡ï¼‰ï¼Ÿ                 | 4 stars | åŠ¨æ€åŠ è½½ã€JNI        |
| 25   | å¦‚ä½•ç”¨ **OpenTelemetry** è¿½è¸ªä¸€æ¬¡ AI è¯·æ±‚çš„å…¨é“¾è·¯ï¼ˆJava â†’ Python â†’ LLMï¼‰ï¼Ÿ | 4 stars | åˆ†å¸ƒå¼è¿½è¸ª           |

---

## å…­ã€å¼€æ”¾æ€§ & ç»¼åˆèƒ½åŠ›ï¼ˆ5 é¢˜ï¼‰  
> è€ƒå¯Ÿï¼š**æŠ€æœ¯è§†é‡ã€å­¦ä¹ èƒ½åŠ›ã€é—®é¢˜è§£å†³**

| é¢˜å· | é¢˜ç›®                                                         | éš¾åº¦    | è€ƒå¯Ÿç‚¹       |
| ---- | ------------------------------------------------------------ | ------- | ------------ |
| 26   | ä½ æœ€è¿‘å…³æ³¨äº†å“ªé¡¹ **LLM æ–°æŠ€æœ¯**ï¼Ÿå¦‚ä½•åœ¨ AI IDE ä¸­è½åœ°ï¼Ÿ      | 3 stars | æŠ€æœ¯è¶‹åŠ¿     |
| 27   | å¦‚ä½•é™ä½ **AI å¹»è§‰ï¼ˆHallucinationï¼‰** åœ¨ä»£ç ç”Ÿæˆä¸­çš„å½±å“ï¼Ÿ   | 4 stars | æ¨¡å‹æ•ˆæœä¼˜åŒ– |
| 28   | å¦‚æœç”¨æˆ·åé¦ˆâ€œAI ç”Ÿæˆçš„ä»£ç æœ‰ Bugâ€ï¼Œä½ å¦‚ä½•å®šä½å’Œä¿®å¤ï¼Ÿ        | 4 stars | é—®é¢˜æ’æŸ¥     |
| 29   | ä½ æœ‰ **å¼€æºè´¡çŒ®** å—ï¼Ÿè®²è®²ä½ å‚ä¸çš„é¡¹ç›®å’Œä½œç”¨ã€‚               | 3 stars | ç¤¾åŒºå½±å“åŠ›   |
| 30   | æ‰‹å†™ä¸€ä¸ª **åŸºäº Langchain4j çš„ RAG é—®ç­”æœåŠ¡**ï¼ˆJava å®ç°ï¼‰ã€‚ | 5 stars | ç»¼åˆèƒ½åŠ›     |

---

## æ¨èå‡†å¤‡é‡ç‚¹ï¼ˆé»„é‡‘ä¸‰è§’ï¼‰

```text
æ ¸å¿ƒèƒ½åŠ›ä¸‰è§’ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Java åç«¯      â”‚ â† Spring Bootã€å¹¶å‘ã€æ€§èƒ½
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   AI é›†æˆ        â”‚ â† ONNXã€RAGã€Agentã€Prompt
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   äº‘åŸç”Ÿè¿ç»´     â”‚ â† K8sã€CI/CDã€å¯è§‚æµ‹æ€§
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æ¨¡æ‹Ÿé¢è¯•æµç¨‹å»ºè®®ï¼ˆ60 åˆ†é’Ÿï¼‰

| æ—¶é—´      | ç¯èŠ‚                | å»ºè®®é¢˜ç›®                               |
| --------- | ------------------- | -------------------------------------- |
| 0-10 min  | è‡ªæˆ‘ä»‹ç» + é¡¹ç›®ç»å† | å‡†å¤‡ 1 ä¸ª AI+Java é¡¹ç›®                 |
| 10-40 min | æŠ€æœ¯æ·±æŒ–            | é€‰ 3 é¢˜ï¼šç³»ç»Ÿè®¾è®¡ + AI é›†æˆ + æ€§èƒ½ä¼˜åŒ– |
| 40-55 min | å¼€æ”¾è®¨è®º            | è¶‹åŠ¿ã€å¼€æºã€èŒä¸šè§„åˆ’                   |
| 55-60 min | åé—®ç¯èŠ‚            | å›¢é˜Ÿã€æŠ€æœ¯æ ˆã€æŒ‘æˆ˜                     |

---

## èµ„æºæ¨è

| ç±»å‹       | èµ„æº                                                         |
| ---------- | ------------------------------------------------------------ |
| AI æ¡†æ¶    | [Spring AI](https://spring.io/projects/spring-ai)ã€[LangChain4j](https://github.com/langchain4j/langchain4j) |
| å‘é‡æ•°æ®åº“ | Pineconeã€Milvusã€Qdrant                                     |
| æ¨¡å‹æ ¼å¼   | ONNXã€GGUF                                                   |
| äº‘åŸç”Ÿ     | ã€ŠKubernetes in Actionã€‹ã€Istio å®˜ç½‘                         |
| å¼€æºé¡¹ç›®   | [Trae](https://github.com/Trae-AI/Trae)ï¼ˆå¦‚æœ‰ï¼‰ã€[DevGPT](https://github.com/DevGPT) |

---





**ç»“è®ºï¼šå¤§å‚ï¼ˆé˜¿é‡Œã€å­—èŠ‚ã€è…¾è®¯ã€ç™¾åº¦ã€ç¾å›¢ã€äº¬ä¸œç­‰ï¼‰åç«¯é¢è¯•ï¼Œ** **90% ä»¥ä¸Šä¼šè€ƒæ‰‹å†™ç®—æ³•é¢˜**ï¼Œå°¤å…¶æ˜¯åœ¨ **AI åº”ç”¨æœåŠ¡ç«¯ã€ç³»ç»Ÿè®¾è®¡ã€åç«¯ç ”å‘** ç­‰å²—ä½ä¸­ï¼Œ**ç®—æ³•æ˜¯å¿…è€ƒç¯èŠ‚**ï¼Œä¸”é€šå¸¸æ˜¯ **â€œå¡äººâ€ é¡¹**ã€‚

---

## ä¸€ã€å¤§å‚ç®—æ³•é¢è¯•ç°çŠ¶ï¼ˆ2025 æœ€æ–°ï¼‰

| å¤§å‚     | æ˜¯å¦è€ƒæ‰‹å†™ç®—æ³•    | é¢˜é‡   | éš¾åº¦        | å½¢å¼                     |
| -------- | ----------------- | ------ | ----------- | ------------------------ |
| å­—èŠ‚è·³åŠ¨ | å¿…è€ƒ              | 3â€“5 é¢˜ | ä¸­ç­‰å Hard | åœ¨çº¿ codingï¼ˆç‰›å®¢/åŠ›æ‰£ï¼‰ |
| é˜¿é‡Œå·´å·´ | å¿…è€ƒ              | 2â€“3 é¢˜ | ä¸­ç­‰+       | ç°åœº/è¿œç¨‹ç™½æ¿ã€å…±äº«æ–‡æ¡£  |
| è…¾è®¯     | å¿…è€ƒ              | 2â€“3 é¢˜ | ä¸­ç­‰        | è…¾è®¯ä¼šè®®å…±äº«å±å¹•         |
| ç™¾åº¦     | å¿…è€ƒï¼ˆAI å²—æ›´é‡ï¼‰ | 3 é¢˜   | ä¸­ç­‰        | ç‰›å®¢ç½‘                   |
| ç¾å›¢     | å¿…è€ƒ              | 2â€“3 é¢˜ | ä¸­ç­‰        | ç°åœºç™½æ¿                 |
| äº¬ä¸œ     | å¿…è€ƒ              | 2 é¢˜   | ä¸­ç­‰        | çº¿ä¸Š coding              |

> **AI åº”ç”¨æœåŠ¡ç«¯å²—ï¼ˆå¦‚ Traeï¼‰ä¹Ÿä¸ä¾‹å¤–**ï¼šè™½ç„¶é‡ç³»ç»Ÿè®¾è®¡ï¼Œä½† **ç®—æ³•æ˜¯åŸºç¡€èƒ½åŠ›éªŒè¯**ï¼Œå¸¸è€ƒ **å­—ç¬¦ä¸²ã€æ ‘ã€å›¾ã€åŠ¨æ€è§„åˆ’ã€æ»‘åŠ¨çª—å£**ã€‚

---

## äºŒã€ä¸ºä»€ä¹ˆå¤§å‚åšæŒè€ƒæ‰‹å†™ç®—æ³•ï¼Ÿ

| åŸå›                       | è§£é‡Š                                               |
| ------------------------- | -------------------------------------------------- |
| **1. ç­›é€‰åŸºç¡€èƒ½åŠ›**       | ç®—æ³•åæ˜  **æ•°æ®ç»“æ„æŒæ¡ã€é€»è¾‘æ€ç»´ã€è¾¹ç•Œå¤„ç†** èƒ½åŠ› |
| **2. å¿«é€Ÿè¿‡æ»¤**           | 1 å°æ—¶å†…å¯åˆ¤æ–­å€™é€‰äººæ˜¯å¦â€œèƒ½å†™ä»£ç â€                 |
| **3. æ ‡å‡†åŒ–è¯„ä¼°**         | ç®—æ³•é¢˜å®¢è§‚ã€å¯é‡åŒ–ï¼Œé¿å…ä¸»è§‚åå·®                   |
| **4. é«˜å¹¶å‘ç³»ç»Ÿåº•å±‚é€»è¾‘** | åˆ†å¸ƒå¼ IDã€è´Ÿè½½å‡è¡¡ã€ç¼“å­˜æ·˜æ±° â†’ éƒ½æºäºç®—æ³•         |

> å³ä½¿ä½ æ˜¯ **10 å¹´ Java è€å…µ**ï¼Œ**å†™ä¸å‡ºã€ŒLRU ç¼“å­˜ã€**ï¼Œä¹Ÿå¯èƒ½è¢«ä¸€ç¥¨å¦å†³ã€‚

---

## ä¸‰ã€AI åº”ç”¨æœåŠ¡ç«¯å²—å¸¸è€ƒç®—æ³•é¢˜å‹ï¼ˆTop 10ï¼‰

| é¢˜å‹                     | ä»£è¡¨é¢˜ç›®                                                     | è€ƒå¯Ÿç‚¹                        | æ¨èç»ƒä¹  |
| ------------------------ | ------------------------------------------------------------ | ----------------------------- | -------- |
| **1. å“ˆå¸Œè¡¨ + æ»‘åŠ¨çª—å£** | [3. æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²](https://leetcode.cn/problems/longest-substring-without-repeating-characters/) | çª—å£æ”¶ç¼©ã€å­—ç¬¦è®¡æ•°            | åŠ›æ‰£ 3   |
| **2. åŒæŒ‡é’ˆ**            | [11. ç››æœ€å¤šæ°´çš„å®¹å™¨](https://leetcode.cn/problems/container-with-most-water/) | è´ªå¿ƒã€æŒ‡é’ˆç§»åŠ¨                | åŠ›æ‰£ 11  |
| **3. äºŒå‰æ ‘éå†**        | [94. äºŒå‰æ ‘çš„ä¸­åºéå†](https://leetcode.cn/problems/binary-tree-inorder-traversal/) | é€’å½’ã€æ ˆã€Morris              | åŠ›æ‰£ 94  |
| **4. åŠ¨æ€è§„åˆ’**          | [72. ç¼–è¾‘è·ç¦»](https://leetcode.cn/problems/edit-distance/)  | çŠ¶æ€è½¬ç§»ã€ç©ºé—´ä¼˜åŒ–            | åŠ›æ‰£ 72  |
| **5. å›¾ï¼ˆBFS/DFSï¼‰**     | [200. å²›å±¿æ•°é‡](https://leetcode.cn/problems/number-of-islands/) | ç½‘æ ¼æœç´¢ã€visited æ ‡è®°        | åŠ›æ‰£ 200 |
| **6. å †/ä¼˜å…ˆé˜Ÿåˆ—**       | [23. åˆå¹¶ K ä¸ªå‡åºé“¾è¡¨](https://leetcode.cn/problems/merge-k-sorted-lists/) | å°é¡¶å †ã€é“¾è¡¨æ“ä½œ              | åŠ›æ‰£ 23  |
| **7. è®¾è®¡æ•°æ®ç»“æ„**      | [146. LRU ç¼“å­˜](https://leetcode.cn/problems/lru-cache/)     | **é«˜é¢‘ï¼** HashMap + åŒå‘é“¾è¡¨ | åŠ›æ‰£ 146 |
| **8. å­—ç¬¦ä¸²å¤„ç†**        | [5. æœ€é•¿å›æ–‡å­ä¸²](https://leetcode.cn/problems/longest-palindromic-substring/) | ä¸­å¿ƒæ‰©å±•ã€Manacher            | åŠ›æ‰£ 5   |
| **9. äºŒåˆ†æŸ¥æ‰¾**          | [33. æœç´¢æ—‹è½¬æ’åºæ•°ç»„](https://leetcode.cn/problems/search-in-rotated-sorted-array/) | è¾¹ç•Œå¤„ç†                      | åŠ›æ‰£ 33  |
| **10. ä½è¿ç®—**           | [136. åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—](https://leetcode.cn/problems/single-number/) | å¼‚æˆ–æ€§è´¨                      | åŠ›æ‰£ 136 |

> **é‡ç‚¹èƒŒä¼š**ï¼š**LRUã€æ»‘åŠ¨çª—å£ã€äºŒå‰æ ‘ã€åŠ¨æ€è§„åˆ’** â€”â€” å‡ºç°æ¦‚ç‡ > 80%

---

## å››ã€çœŸå®é¢è¯•æ¡ˆä¾‹ï¼ˆå­—èŠ‚ AI åç«¯ï¼‰

> **é¢è¯•å®˜**ï¼šè¯·æ‰‹å†™ã€ŒLRU ç¼“å­˜ã€ï¼Œè¦æ±‚æ”¯æŒ `get` å’Œ `put` æ“ä½œï¼Œæ—¶é—´å¤æ‚åº¦ O(1)ã€‚

```java
class LRUCache {
    class Node {
        int key, val;
        Node prev, next;
        Node(int k, int v) { key = k; val = v; }
    }

    private Map<Integer, Node> map;
    private Node head, tail;
    private int capacity;

    public LRUCache(int capacity) {
        this.capacity = capacity;
        map = new HashMap<>();
        head = new Node(0, 0);
        tail = new Node(0, 0);
        head.next = tail;
        tail.prev = head;
    }

    public int get(int key) {
        Node node = map.get(key);
        if (node == null) return -1;
        moveToHead(node);
        return node.val;
    }

    public void put(int key, int value) {
        Node node = map.get(key);
        if (node != null) {
            node.val = value;
            moveToHead(node);
        } else {
            Node newNode = new Node(key, value);
            map.put(key, newNode);
            addToHead(newNode);
            if (map.size() > capacity) {
                Node last = removeTail();
                map.remove(last.key);
            }
        }
    }

    private void addToHead(Node node) {
        node.prev = head;
        node.next = head.next;
        head.next.prev = node;
        head.next = node;
    }

    private void removeNode(Node node) {
        node.prev.next = node.next;
        node.next.prev = node.prev;
    }

    private void moveToHead(Node node) {
        removeNode(node);
        addToHead(node);
    }

    private Node removeTail() {
        Node last = tail.prev;
        removeNode(last);
        return last;
    }
}
```

> **é€šè¿‡å…³é”®**ï¼š**è¾¹ç•Œå¤„ç†å¹²å‡€ã€é“¾è¡¨æ“ä½œæ— è¯¯ã€ä»£ç ç»“æ„æ¸…æ™°**

---

## äº”ã€å¤‡æˆ˜å»ºè®®ï¼ˆ30 å¤©åˆ·é¢˜è®¡åˆ’ï¼‰

| å‘¨æ•°    | ç›®æ ‡     | æ¯æ—¥ä»»åŠ¡                        |
| ------- | -------- | ------------------------------- |
| ç¬¬ 1 å‘¨ | æ‰“åŸºç¡€   | åˆ· **Top 100 Liked**ï¼Œæ¯å¤© 3 é¢˜ |
| ç¬¬ 2 å‘¨ | åˆ†ç±»çªç ´ | æ¯å¤© 1 ç§é¢˜å‹ï¼ˆå“ˆå¸Œã€æ ‘ã€DPï¼‰   |
| ç¬¬ 3 å‘¨ | æ¨¡æ‹Ÿé¢è¯• | æ¯å¤© 2 é¢˜ï¼Œ**æ‰‹å†™ + å¤ç›˜**      |
| ç¬¬ 4 å‘¨ | æŸ¥æ¼è¡¥ç¼º | åš **å¤§å‚çœŸé¢˜**ï¼ˆå­—èŠ‚ã€é˜¿é‡Œï¼‰   |

> **æ¨èå¹³å°**ï¼š
> - [LeetCode CN](https://leetcode.cn/)
> - [ç‰›å®¢ç½‘](https://www.nowcoder.com/)
> - [CodeTop](https://codetop.cc/)ï¼ˆå¤§å‚é«˜é¢‘é¢˜ï¼‰

---

## å…­ã€AI åº”ç”¨æœåŠ¡ç«¯å²—ç®—æ³•é¢è¯•æŠ€å·§

| æŠ€å·§                    | è¯´æ˜                                       |
| ----------------------- | ------------------------------------------ |
| **1. è¯´æ€è·¯ï¼Œå†å†™ä»£ç ** | å…ˆè¯­ï¼š**â€œæˆ‘ç”¨å“ˆå¸Œè¡¨ + åŒæŒ‡é’ˆï¼Œæ—¶é—´ O(n)â€** |
| **2. å†™å®Œåè‡ªæµ‹**       | ç»™ 1-2 ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼ŒéªŒè¯è¾¹ç•Œ                |
| **3. ä¼˜åŒ–ç©ºé—´**         | é—®é¢è¯•å®˜æ˜¯å¦éœ€è¦ O(1) ç©ºé—´                 |
| **4. ç”»å›¾è¾…åŠ©**         | æ ‘ã€é“¾è¡¨ã€æ»‘åŠ¨çª—å£ â†’ ç”»å‡ºæ¥æ›´æ¸…æ™°          |
| **5. ä¸»åŠ¨è¯´æ˜å¤æ‚åº¦**   | æ—¶é—´ + ç©ºé—´ï¼Œä½“ç°å·¥ç¨‹æ€ç»´                  |

---

## ä¸ƒã€æ€»ç»“ï¼š**ç®—æ³• = å…¥åœºåˆ¸**

| å²—ä½                | ç®—æ³•é‡è¦æ€§                 |
| ------------------- | -------------------------- |
| æ™®é€š CRUD åç«¯      | 3 starsï¼ˆå¯èƒ½ä¸è€ƒï¼‰        |
| å¤§å‚åç«¯ / ç³»ç»Ÿè®¾è®¡ | 5 starsï¼ˆå¿…è€ƒï¼‰            |
| **AI åº”ç”¨æœåŠ¡ç«¯**   | **5 starsï¼ˆå¿…è€ƒ + é«˜é¢‘ï¼‰** |

> **è®°ä½**ï¼š  
> **â€œä¸ä¼šæ‰‹å†™ LRUï¼Œè¿ç³»ç»Ÿè®¾è®¡éƒ½ä¸è®©èŠã€‚â€**

---

**è¡ŒåŠ¨è®¡åˆ’**ï¼š
1. **ä»Šå¤©å¼€å§‹**ï¼šåˆ· [LeetCode 146 LRU](https://leetcode.cn/problems/lru-cache/)
2. **æ¯å¤© 2 é¢˜**ï¼ŒåšæŒ 30 å¤©
3. **æ‰¾äººæ¨¡æ‹Ÿé¢è¯•**ï¼Œæ¯å‘¨ 1 æ¬¡

éœ€è¦æˆ‘ç»™ä½  **å®šåˆ¶ 30 å¤©åˆ·é¢˜è¡¨** æˆ– **1v1 æ¨¡æ‹Ÿç®—æ³•é¢è¯•**ï¼Œéšæ—¶è¯´ï¼









SHEIN

1. è‡ªå·±çš„é¡¹ç›®è¦è¯´çš„æ¡ç†æ€§æ›´å¼ºä¸€äº›ï¼Œè¯­é€Ÿæ”¾æ…¢ï¼Œç»™é¢è¯•å®˜æ—¶é—´ååº”ä½ è¯´çš„ä¸œè¥¿å¹¶è§£ç­”
2. Mysql éšå¼ç±»å‹è½¬æ¢å¸¦æ¥çš„æŸ¥è¯¢é—®é¢˜ï¼Œmysql è°ƒä¼˜
3. ç”¨ redis å®ç°ä¸€ä¸ªåˆ†å¸ƒå¼é”
4. åœºæ™¯è®¾è®¡é¢˜ï¼Œä¸€ä¸ªè´¦æˆ·æ¯ç§’ 20w qps çš„é‡‘é¢åŠ å‡ï¼Œå¦‚ä½•å¤„ç†ï¼Ÿ

å¤§èƒ†ä¸€äº›ï¼Œå¤šé—®ä¸€äº›å‰æï¼Œä¸è¦æƒ³å¤ªå¤šå¼ºç¡¬çš„ç»“é¢˜æ€è·¯ã€‚é€‚å½“ç›´æ¥é—®é¢è¯•å®˜ï¼Œç›´æ¥å†™ä¸‹æ¥è¿›è¡Œæ€è€ƒ

5. ä¸€å®šè¦è¡¨ç°çš„ç¨³é‡ä¸€äº›ï¼Œæœ‰æ¡ä¸ç´Š
6. ä¸¤ä¸ªå¤§ list æ‰¾å·®é›†ï¼Œæœ€å¿«çš„æ–¹å¼

offerğŸ’¥ğŸ’¥ğŸ’¥

æºç¨‹

1. é¡¹ç›®æ²¡æ€ä¹ˆé—®ï¼Œæ›´å¤šçš„æ˜¯ç®—æ³•
2. ä¸€é“ hard ï¼ˆæ»‘åŠ¨çª—å£ï¼‰ï¼Œä¸¤é“ m ï¼ˆæœ€é•¿å›æ–‡å­ä¸²ï¼Œsql æŸ¥è¯¢ï¼‰

PSï¼šä¸æƒ³æ‹›äººï¼Œçº¯çº¯æ¥å†™é¢˜çš„ï¼Œé¢è¯•å®˜å…¨ç¨‹å¿ƒä¸åœ¨ç„‰ã€‚

é»‘æ¹–
ä¸€é¢

1. åè½¬é“¾è¡¨å˜ç§ï¼ˆåè½¬ä» start åˆ° end çš„ä½ç½®ï¼‰
2. é¡¹ç›®ç»†èŠ‚

äºŒé¢

1. åšäº‹æƒ…çš„æ–¹å¼ï¼Œæå‰æ²Ÿé€šèµ„æºï¼Œä¿è¯è‡ªå·±äº§å‡º
2. è·¨å›¢é˜Ÿå» coding
3. æ´’è„±ä¸€äº›ï¼Œä¸€ä¸ªé—®é¢˜æ²¡ç­”å¥½ï¼Œåˆ«çº ç»“
4. å®ç°ä¸€ä¸ª Double.parseDouble

"12.13" -> 12.13
"12" -> 12.0
"a123.123" -> exception
PSï¼šå¯¹è‡ªå·±ä¹‹å‰è§è¿‡çš„æ•…éšœå’Œé”™è¯¯ï¼ŒåŠæ—¶å¤ç›˜æ€»ç»“ï¼Œæ‰¾è¡Œä¸šå¯¹åº”çš„æ–¹æ¡ˆå»åšé¢„é˜²

Xtransfer

1. é™æµå™¨çš„ç»†èŠ‚ï¼Œå¤šä¸ªé™æµå™¨çš„åŒºåˆ«ï¼Œåˆ†åˆ«å¤„ç†ä»€ä¹ˆåœºæ™¯
2. ES çš„æ•°æ®å€¾æ–œï¼Œå¦‚ä½•è§£å†³
3. Redis åˆ†å¸ƒå¼é”çš„å®ç°ï¼Œredis çœ‹é—¨ç‹—ä½œç”¨çš„èŒƒå›´ï¼Œredis çš„æ•°æ®ç±»å‹æœ‰å“ªäº›ï¼Œåˆ†åˆ«ä½¿ç”¨åœºæ™¯
4. ç”»å‡º Kafka çš„æ¶æ„å›¾ï¼Œå¦‚ä½•å®ç°ä¸€ä¸ªä¸€ä¸ªæ¶ˆæ¯ï¼Œå¤šç‚¹å¹¿æ’­æ¶ˆè´¹ï¼Œä¸ç”¨æ¶ˆè´¹ç»„
5. ç®—æ³•é¢˜ï¼Œä¸‹ä¸€ä¸ªåºåˆ—

PSï¼šä¸­é—´ä»¶çš„å…«è‚¡æ–‡ä¸¥é‡ä¸è¶³ï¼Œéœ€è¡¥å……

é€”è™
ä¸€é¢

1. å»é‡æ•°ç»„
2. æ„Ÿè§‰æ²¡ä»€ä¹ˆå¯ä»¥è¯´çš„ï¼Œç‚¹å¯¹ä¸ä¸Š
3. è‚¯å®š G


å›å“ç§‘æŠ€
ä¸€é¢

1. update set amount = amount - 1 where amount > 0 and id = 1 è¡Œé”ä¸ä¼šè¶…å–
2. æ’è¡Œæ¦œ sort set å–å€¼çš„æŠ€å·§ ï¼Œsort set åº•å±‚çš„å®ç°
3. mysql update ä»æäº¤åˆ°è¿”å›çš„è¿‡ç¨‹
4. å•åˆ—ç´¢å¼•ï¼Œè”åˆç´¢å¼•çš„å­˜å‚¨åŒºåˆ«
5. Mysql åˆ·ç›˜çš„æ•´ä¸ªè¿‡ç¨‹
6. ç®—æ³• m è·å–ä¸€ä¸ªäºŒå‰æ ‘çš„æ‰€æœ‰å³èŠ‚ç‚¹

PS: ä¸­é—´ä»¶å¤ªæ·±äº†ï¼Œè‡ªå·±ä¸äº†è§£ï¼Œèœäº†
äºŒé¢

1. å±…ç„¶è¿‡äº†ã€‚ç¥å¥‡ã€‚ç­‰å¾…ä¸­ã€‚
2. æŠ€æœ¯è´Ÿè´£äººçªç„¶æœ‰äº‹æƒ…ï¼Œæ¥ä¸äº†ï¼Œç›´æ¥ HR é¢ã€‚
3. é¢„æœŸè–ªèµ„ä¼šæ¯”è¾ƒä½ï¼Œä¸è¶…è¿‡ 35

ä¸‰é¢

1. è®¾è®¡ä¸€ä¸ªå…³æ³¨äººå’Œè¢«å…³æ³¨äººçš„åœºæ™¯ï¼Œæ€ä¹ˆæ›´åˆç†æ›´å¿«çš„æŸ¥è¯¢
2. é’±è°ˆä¸æ‹¢ gg


é¹°è§’ç½‘ç»œ
ä¸€é¢

1. çˆ¶ç±»å­ç±»æ–¹æ³•çš„æ‰§è¡Œ
2. æƒé™ç³»ç»Ÿçš„è®¾è®¡
3. ä¸€ä¸ªæ¥å£åœ¨æœ¬åœ°æ‰§è¡Œå¾ˆå¿«ï¼Œæµ‹è¯•ç¯å¢ƒå°±å¾ˆæ…¢ä¸ºä»€ä¹ˆ
4. ä¸€äº› spring springboot çš„ç›¸å…³é¢è¯•é¢˜
5. å†…æ¨çš„ï¼Œå’Œä¸€é¢çš„äººç†Ÿæ‚‰ï¼Œç»“æœåé¦ˆè¯´è¿˜è¡Œï¼Œ7/8 åˆ†åº”è¯¥ä¼šæœ‰äºŒé¢

äºŒé¢

1. é¢è¯„è¯´æŠ€æœ¯æ·±åº¦å¹¿åº¦ä¸é”™ï¼Œä½†æ˜¯æ— æƒé™å’Œæµç¨‹ç»éªŒ gg


äº¬ä¸œ

1. é¢è¯•å¤šé—®ä¸€äº›é¡¹ç›®ä¸­çš„ç»†èŠ‚ç‚¹ï¼ŒæŠ€æœ¯å‚æ•°è®¾ç½®çš„æ¥æº
2. ä¸­é—´ä»¶çš„ä½¿ç”¨ï¼Œåˆ†å¸ƒå¼é”å®ç°çš„ç»†èŠ‚ç‚¹ï¼Œä»¥åŠ Redisson çš„æºç 
3. Kafka æ¶ˆè´¹çš„é¡ºåº
4. é—®äº†æ‰‹ä¸Šçš„ offer ï¼Œå¸Œæœ›æœ‰äºŒé¢
5. æ— å¯¹åº”çº§åˆ«çš„ hc ï¼Œgg


ç±³å“ˆæ¸¸

1. æœ€é•¿ä¸é‡å¤å­ä¸²
2. é—®äº†æ‰‹ä¸Šçš„ offer ï¼Œå¸Œæœ›æœ‰äºŒé¢
3. gg ï¼ŒåŸå› ä¸æ˜ã€‚é¡¹ç›®èŠçš„æŒºå¥½ï¼Œä¸­é—´ä»¶ç­‰ç­‰éƒ½ ok ï¼Œç®—æ³•é¢˜ä¹Ÿåšå‡ºæ¥äº†ã€‚


æºç¨‹å›½é™…æœºç¥¨

1. ç»™å®šä¸€å­—ç¬¦ä¸²ï¼ŒåŒ…å«æ•°å­—ã€å­—æ¯ã€å°æ•°ç‚¹å’Œæ­£è´Ÿå·ï¼Œä»ä¸­æå–æœ€å¤§çš„æ•°å­— abc56ghf-78.3hjk+65.6aaa ç”¨é«˜æ•ˆçš„æ–¹å¼å»åšã€‚
2. gg ï¼Œç®—æ³•é¢˜å†™çš„æ€§èƒ½ä¸å¥½ã€‚


ä¼—å®‰ä¿
é‡‘èäº‹ä¸šéƒ¨
offerğŸ’¥ğŸ’¥ğŸ’¥

å¾—ç‰©
ç«ä»·&&åº“å­˜

1. ç»“åˆå¾—ç‰©çš„åœºæ™¯ï¼Œçªç„¶çš„ç§’æ€åœºæ™¯ï¼Œå¦‚ä½•è¿›è¡Œåº“å­˜æ‰£å‡ã€‚
2. å¦‚ä½•è¿›è¡Œç¼“å­˜å’Œ db çš„åº“å­˜ä¿®æ”¹
3. åœºæ™¯é¢˜ç­”çš„ç»†èŠ‚ä¸å¥½ï¼Œä¹Ÿä¸å¤ªç¬¦åˆç»å†ï¼Œgg

å•†å“æœç´¢

1. å¾…é¢è¯•ï¼Œå¦‚æœæœ‰å¾—ç‰©åŒå­¦æŒ‡å¯¼ä¸€ä¸‹ï¼Œå…ˆæ‹œè°¢äº†ã€‚æŒºæƒ³å»çš„ï¼Œæ¯•ç«Ÿé’±å¤šï¼Œä¸šåŠ¡åœºæ™¯ä¹Ÿæ¯”è¾ƒå–œæ¬¢ã€‚


é¥¿äº†ä¹ˆ

1. ä¸€ä¸ªå®šæ—¶è°ƒåº¦ç³»ç»Ÿï¼Œå¦‚ä½•è¿›è¡Œå‡†æ—¶çš„è§¦å‘ã€‚
2. ä¸€ä¸ªåº“å­˜è¡Œæ‰£å‡æ˜¯ 400qps ï¼Œå¦‚ä½•æå‡ï¼Ÿ
3. æ‹†åˆ†åº“å­˜è¡Œåï¼Œç°åœ¨ 1 å•è¦ä¹° 2 ä¸ªï¼Œè¿™ä¸¤ä¸ªåº“å­˜åˆ†åˆ«åœ¨ 2 ä¸ªåº“å­˜è¡Œæ€ä¹ˆå¤„ç†
4. å¦‚ä½•å¤„ç†è·¨æœåŠ¡çš„çº¿ç¨‹å†…å€¼ä¼ é€’
5. ä¸¤ä¸ªå¤§æ•°ç›¸åŠ ï¼Œå¦‚ä½•å»åš
6. å¦‚æœä½ æ˜¯æ¶æ„å¸ˆï¼Œå¦‚ä½•ä¿è¯ç³»ç»Ÿçš„å¯ç”¨æ€§
7. ä½ æ˜¯å¦‚ä½•ç†è§£ CAP ï¼Ÿ
8. ä¸ºä»€ä¹ˆè·³æ§½é¢‘ç¹å’ŒåŸå› ï¼Œæ˜¯ä¸æ˜¯å¯¹è‡ªå·±æ²¡æœ‰èŒä¸šè§„åˆ’ã€‚å·²ç» gg